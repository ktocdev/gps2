# GPS2 Sprint - October 27, 2025

**Started:** October 27, 2025
**Status:** Phase 4 Complete ✅ - Beginning Phase 4.5 Polish & Testing 🔍
**Branch:** GPS2-39
**Previous Sprint:** [SPRINT-2025-10-20.md](archive/SPRINT-2025-10-20.md)

---

## 🎉 **Phase 4 Complete!**

### Systems 17-21: Guinea Pig Integration ✅ **ALL COMPLETE**

**Status:** ✅ Completed October 27, 2025
**Implementation Time:** ~5-7 weeks (38-53 hours total)

All Phase 4 systems implemented and tested:
- ✅ **System 17:** Visual Presence & Positioning - GuineaPigSprite with breed-specific emoji, grid positioning, selection state
- ✅ **System 18:** Pathfinding & Movement - A* pathfinding, movement controller, CSS animations
- ✅ **System 19:** Autonomous AI Behaviors - AI decision matrix (10 subsystems), all autonomous actions
- ✅ **System 20:** Direct Interaction System - Manual socialize trigger, dual movement, adjacent positioning
- ✅ **System 21:** Social Bonding System - Bond management, bonding progression (0-100), localStorage serialization

**Key Features:**
- Complete autonomous AI with 12 behavior types (eat, drink, sleep, groom, chew, play, shelter, popcorn, zoomies, hide, watch, poop)
- Personality-driven behavior variations
- Multi-guinea pig support fully tested and stable
- Comprehensive debug tools for testing and observation
- Activity feed integration for all behaviors
- Social bonding between guinea pig pairs

**Documentation:**
- [Phase 4 Guinea Pig Integration Plan](systems/phase4/phase-4-guinea-pig-integration-plan-full.md)
- [System 17: Visual Presence & Positioning](systems/phase4/system-17-visual-presence-positioning.md)
- [System 18: Pathfinding & Movement](systems/phase4/system-18-pathfinding-movement.md)
- [System 19: Autonomous AI Behaviors](systems/phase4/system-19-autonomous-ai-behaviors.md)
- [System 20: Direct Interaction System](systems/phase4/system-20-direct-interaction-system.md)
- [System 21: Social Bonding System](systems/phase4/system-21-social-bonding-system.md)

---

## 🔍 **Phase 4.5: Polish & Testing**

**Status:** 🚧 **IN PROGRESS**
**Priority:** HIGH
**Goal:** Manual gameplay testing, balance adjustments, metadata fixes, and UI polish before Phase 5

### Critical Bug Fixes 🔥

#### Wellness Calculation Always at 0% ⚠️ **CRITICAL**
**Priority:** CRITICAL
**Status:** 📋 Not Started

**Issue:** Wellness meter stuck at 0% despite needs being satisfied

**Investigation Needed:**
- Check wellness calculation formula in needsController.ts
- Verify needs are being read correctly for wellness calculation
- Test with manual need adjustments to see if wellness responds
- Check for division by zero or incorrect averaging

**Files to Check:**
- `src/stores/needsController.ts` - Wellness calculation
- `src/stores/guineaPigStore.ts` - Need values and wellness integration

---

### Food System Rebalancing 🍎

#### Food Serving Amounts 📋 **Planned**
**Priority:** HIGH
**Status:** 📋 Not Started

**Current Issue:** All food items default to generic serving counts

**New Serving Amounts:**

**Vegetables (varies):**
- 🥕 Carrots: 4 servings per item
- 🥒 Cucumber: 6 servings per item
- 🥬 Zucchini: 6 servings per item
- 🌿 Celery: 6 servings per item
- 🥦 Broccoli: 4 servings per item
- 🍅 Cherry Tomato: 1 servings per item

**Fruits (varies):**
- 🍎 Apple: 4 servings per item
- 🍓 Strawberry: 1 serving per item
- 🫐 Blueberry: 1 serving per item
- 🍌 Banana: 4 servings per item
- 🍉 Melon: 6 servings per item
- 🍊 Orange: 4 servings per item
- 🍐 Pear: 4 servings per item

**Herbs & Greens:**
- 🌿 Herbs: ~6 servings per bunch (current value OK)
- 🥬 Greens: ~6 servings per bunch (current value OK)

**Files to Modify:**
- `src/data/supplies/food/*.json` - Update `servings` field for each food item
- Test inventory consumption and food bowl mechanics with new values

---

#### Food Activity Messages 📋 **Planned**
**Priority:** MEDIUM
**Status:** 📋 Not Started

**Current Issue:** Activity messages say generic "ate [food]" for all foods

**New Message Format:**
- **All fruits and vegetables:** "[Guinea pig name] ate a [food] piece"
  - Example: "Cinnamon ate a carrot piece"
  - Example: "Hazel ate a banana piece"
  - Example: "Butterscotch ate an apple piece"
  - Example: "Peanut ate a blueberry piece"
  - Example: "Mocha ate a cherry tomato piece"

**Implementation:**
- Update food consumption messages to use "a [food] piece" format
- Article handling (a/an) for piece messages
- Apply to all fruits and vegetables consistently

**Files to Modify:**
- `src/utils/messageGenerator.ts` - Update food consumption messages

---

#### Poop Activity Messages 📋 **Planned**
**Priority:** LOW
**Status:** 📋 Not Started

**Current Issue:** Poop messages say "left poop near the floor" which doesn't make sense

**Examples of Current Bad Messages:**
- "Cinnamon left poop near the floor"
- "Hazel left poop near the hideaway"

**New Message Format:**
- Remove location references entirely for poop
- Simple message: "[Guinea pig name] left a poop"
- Or alternative: "[Guinea pig name] pooped"

**Files to Modify:**
- `src/utils/messageGenerator.ts` - Update poop behavior messages
- Remove location parameter from poop message generation

---

### UI/UX Improvements 🎨

#### Auto-Select Guinea Pig in Debug Panels 📋 **Planned**
**Priority:** MEDIUM
**Status:** 📋 Not Started

**Goal:** Clicking a guinea pig sprite should automatically switch Autonomy Controls and Needs Panel to that guinea pig

**Current Behavior:**
- Clicking guinea pig shows selection ring
- Must manually toggle between guinea pigs in debug panels
- No connection between sprite selection and panel focus

**New Behavior:**
- Clicking guinea pig sprite selects it (existing)
- Automatically switches Autonomy Controls panel to that guinea pig
- Automatically switches Needs Panel to that guinea pig
- Visual feedback showing which guinea pig is selected in panels

**Implementation:**
- Listen for guinea pig selection change in HabitatVisual
- Update `selectedGuineaPigIndex` in both AutonomyDebug and NeedsPanel
- Emit event or use shared state for selection sync

**Files to Modify:**
- `src/components/game/habitat/HabitatVisual.vue` - Emit selection event
- `src/components/debug/environment/AutonomyDebug.vue` - Listen for selection
- `src/components/debug/environment/NeedsPanel.vue` - Listen for selection
- Consider creating shared selection state in behaviorStateStore

---

#### Social Bonding Empty State 📋 **Planned**
**Priority:** LOW
**Status:** 📋 Not Started

**Issue:** Social Bonding page shows empty/broken UI when no game session active

**Goal:** Display helpful message when no guinea pigs in game

**Message:**
```
No guinea pigs in game

Start a game session from the Guinea Pigs page to see social bonding data.
```

**Files to Modify:**
- `src/components/debug/gameplay/FriendshipDebug.vue` - Add empty state check

---

### Manual Testing & Balance 🎮

#### Gameplay Testing Checklist 📋 **Planned**
**Priority:** HIGH
**Status:** 📋 Not Started

**Testing Areas:**

**1. Needs & Wellness System**
- [ ] All 11 needs decay at correct rates
- [ ] Wellness calculation reflects actual need state
- [ ] Personality traits affect decay as documented
- [ ] Habitat conditions affect needs appropriately
- [ ] Need thresholds trigger correct autonomous behaviors

**2. Autonomous Behaviors**
- [ ] All 12 behavior types execute correctly
- [ ] Pathfinding handles all habitat layouts
- [ ] Guinea pigs don't get stuck on items
- [ ] Behavior priorities make sense (urgent needs override low needs)
- [ ] Personality affects behavior frequency and effectiveness

**3. Food & Consumption**
- [ ] New serving amounts work correctly
- [ ] Food consumption limits enforce properly
- [ ] Food freshness decays at reasonable rate
- [ ] Guinea pigs prefer liked foods over neutral
- [ ] Guinea pigs avoid disliked foods

**4. Habitat Conditions**
- [ ] Cleanliness decays at reasonable rate
- [ ] Bedding freshness affects comfort appropriately
- [ ] Water level consumption matches guinea pig drinking
- [ ] Hay freshness per-rack works correctly
- [ ] Poop accumulation affects cleanliness

**5. Social Bonding**
- [ ] Bond levels increase with socialize interactions
- [ ] Bond levels persist across sessions
- [ ] Bond levels affect social need satisfaction
- [ ] Multiple guinea pig pairs track independently

**6. Item Metadata & Realism**
- [ ] All item types have correct metadata
- [ ] Chew durability degrades at reasonable rates
- [ ] Hideaway/shelter items provide security
- [ ] Toys increase play satisfaction
- [ ] Food bowls and hay racks function correctly

---

### Realism & Balance Rules 📐

#### Create Realism Guidelines 📋 **Planned**
**Priority:** MEDIUM
**Status:** 📋 Not Started

**Goal:** Document realistic guinea pig care guidelines for game balance

**Topics to Cover:**
1. **Feeding Frequency & Amounts**
   - How often should guinea pigs need food/water?
   - What's a realistic hunger cycle duration?
   - Hay should be unlimited - guinea pigs graze constantly

2. **Sleep Patterns**
   - Guinea pigs sleep in short bursts (5-10 minutes)
   - 4-6 hours total sleep per day
   - More active at dawn/dusk (crepuscular)

3. **Social Behavior**
   - Guinea pigs are highly social - need companionship
   - Bonding takes weeks/months in real life
   - Play behaviors: popcorning, zoomies, following, grooming

4. **Hygiene & Maintenance**
   - Self-grooming is frequent (multiple times per day)
   - Nails grow slowly (~monthly trimming in real life)
   - Poop frequently (100+ times per day!)
   - Clean habitat reduces stress

5. **Habitat Preferences**
   - Need hiding places for security
   - Enjoy tunnels and exploration
   - Sensitive to cleanliness (varies by personality)
   - Temperature and noise sensitivity

**Output:** Create [game-design/guinea-pig-realism-guide.md](game-design/guinea-pig-realism-guide.md)

---

## 🎯 **High Priority Improvements**

### Bonding Debug UI Cleanup 🔥
**Priority:** HIGH
**Status:** 📋 Not Started

**Goal:** Clean up Social Bonding debug interface and test system thoroughly

**Tasks:**
- [ ] Review FriendshipDebug.vue layout and styling
- [ ] Add empty state message when no game session
- [ ] Test bond level increases with socialize interactions
- [ ] Verify bond data persists across page reloads
- [ ] Test with multiple guinea pig pairs (3+ guinea pigs)
- [ ] Add bond level visualization (progress bar or meter)
- [ ] Ensure bond levels display correctly in guinea pig tooltips

**Files to Modify:**
- `src/components/debug/gameplay/FriendshipDebug.vue` - UI cleanup
- `src/stores/guineaPigStore.ts` - Bond data verification

---

## 📝 **Phase 4.5 Completion Criteria**

Before moving to Phase 5, the following must be complete:

**Critical Fixes:**
- ✅ All Phase 4 systems tested and stable
- [ ] Wellness calculation working correctly (not stuck at 0%)
- [ ] Food serving amounts realistic and balanced
- [ ] Activity messages grammatically correct

**Polish & UX:**
- [ ] Auto-select guinea pig in debug panels
- [ ] Social bonding empty state message
- [ ] All debug panels tested with 1, 2, and 3+ guinea pigs
- [ ] No console errors during normal gameplay

**Testing & Balance:**
- [ ] Manual gameplay testing checklist complete
- [ ] All autonomous behaviors working as expected
- [ ] Realism guidelines documented
- [ ] Game balance feels good for 10-15 minute play sessions

**Documentation:**
- [ ] Phase 4.5 changes documented
- [ ] Realism guide created
- [ ] Any new systems or changes added to DEVELOPMENT_PHASES.md

---

## 🚀 **Next: Phase 5 (Polish & Enhancements)**

**Phase 5 Systems (22-29):**
- System 22: Interaction Enhancement System
- System 23: Enrichment & Resource Management System
- System 24: Progression & Economy System
- System 25: Game Tutorial System
- System 26: Performance Mode System
- System 27: Sound System
- System 28: Settings Preferences Enhancement
- System 29: Guinea Pig Animation System

**See:** [DEVELOPMENT_PHASES.md - Phase 5](DEVELOPMENT_PHASES.md#phase-5-polish--enhancements-systems-22-29)

---

## 🎮 **Testing Checklist**

### Phase 4 Verification
- [x] All 5 systems (17-21) implemented
- [x] Guinea pig sprites render correctly
- [x] Pathfinding works with all item types
- [x] Autonomous behaviors execute reliably
- [x] Social bonding progresses with interactions
- [x] Multi-guinea pig support tested

### Phase 4.5 Testing
- [ ] Wellness calculation shows correct values
- [ ] Food serving amounts match specification
- [ ] Activity messages use correct grammar
- [ ] Guinea pig selection syncs with debug panels
- [ ] Social bonding page shows empty state
- [ ] All realism rules implemented and balanced

---

## 🚀 **Commands**

**Development:**
- `npm run dev` - Start development server
- `npm run build` - Production build (run before commits)
- `npm run preview` - Preview production build

**Git:**
- Current branch: `GPS2-39`
- Main branch: `main`

---

## 📚 **Documentation Links**

- [Project Plan](PROJECT_PLAN.md)
- [Development Phases](DEVELOPMENT_PHASES.md)
- [System Integration](SYSTEM_INTEGRATION.md)
- [Phase 4 Systems](systems/phase4/)
- [Phase 5 Systems](systems/phase5/)
- [Previous Sprint](archive/SPRINT-2025-10-20.md)
