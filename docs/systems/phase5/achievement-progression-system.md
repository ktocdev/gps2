# Achievement & Progression System

**Phase 5, System 17 - Polish & Enhancement**

## Core System Overview

The Achievement & Progression System provides milestone tracking, rewards, and long-term goals that enhance player engagement and recognize meaningful accomplishments in guinea pig care. This system creates structured progression pathways while celebrating both routine care and special achievements.

### Player Level System

A comprehensive leveling system based on cumulative guinea pig friendship that unlocks new content and capabilities as players progress.

#### Level Calculation
- **Level Source:** Total friendship points from all guinea pigs in Stardust Sanctuary (permanent) + active guinea pigs
- **Level Formula:** Cumulative friendship levels determine overall player level
- **Progression Tiers:** Multiple level tiers unlock different content categories

#### Level-Gated Content

**Supplies Store Unlocks**
- **Tier 1 (Levels 1-5):** Basic supplies available from start (cheap bedding, basic food, starter items)
- **Tier 2 (Levels 6-15):** Premium bedding, specialty hay varieties, medium-quality happiness items
- **Tier 3 (Levels 16-30):** Gourmet treats, advanced habitat items, larger cage upgrade
- **Tier 4 (Levels 31-50):** Luxury items, exclusive decorations, premium happiness items
- **Tier 5 (Levels 51+):** Ultra-premium content, rare items, prestige decorations

**Cage Upgrades (Level-Locked)**
- **Small Cage:** Default starting cage (available level 1)
- **Medium Cage:** Unlocked at level 10 - moderate cost, 50% more space
- **Large Cage:** Unlocked at level 20 - high cost, 100% more space, enables multi-pig optimal spacing
- **Deluxe Cage:** Unlocked at level 35 - premium cost, 150% more space, visual prestige

**Future Unlock Categories**
- **Teachable Actions:** Special interaction types unlocked at specific levels
- **Advanced Features:** Multi-pig care enhancements, automation tools
- **Cosmetic Options:** Special coat colors, patterns, accessories for guinea pig creation

#### Level-Based Rewards
- **Currency Bonuses:** Reaching new level tiers grants one-time currency rewards
- **Item Gifts:** Level milestones include free premium items
- **Feature Access:** New gameplay capabilities unlock at major milestones
- **Achievement Recognition:** Visual badges and profile enhancements for high levels

## Achievement Categories

All achievements provide rewards that complement the level system - achievements grant currency and items, while player levels unlock access to purchase premium content. This creates a dual progression system where achievements provide short-term rewards and levels provide long-term content gating.

### 1. Guinea Pig Care Achievements
Recognition for consistent, quality pet care:

#### Daily Care Milestones
- **"Daily Devotion"** - Feed guinea pig every day for 7 consecutive days
- **"Clean Living"** - Clean cage daily for 5 consecutive days
- **"Hydration Hero"** - Refill water bottle daily for 7 consecutive days
- **"Fresh & Clean"** - Refresh bedding daily for 3 consecutive days
- **"Care Champion"** - Complete all daily care tasks for 14 consecutive days

#### Weekly Care Achievements
- **"Weekly Wonder"** - Maintain all needs above 50% for 7 consecutive days
- **"Friendship Builder"** - Increase friendship level by 25 points in one week
- **"Interaction Master"** - Perform 100 different interactions in one week
- **"Environment Expert"** - Maintain habitat conditions above 75% for 7 days

#### Monthly Care Accomplishments
- **"Dedicated Caretaker"** - 30 days of consistent guinea pig care
- **"Wellness Guardian"** - Maintain wellness rating above 60% for 30 days
- **"Friendship Master"** - Achieve maximum friendship level
- **"Care Perfectionist"** - Maintain all needs above 80% for 14 consecutive days

### 2. Collection Achievements
Recognition for exploration and item acquisition:

#### Item Collection Milestones
- **"Toy Collector"** - Own 10 different happiness items
- **"Food Connoisseur"** - Purchase all 8 hay varieties
- **"Veggie Enthusiast"** - Purchase all 12 vegetable types
- **"Fruit Fanatic"** - Purchase all 10 fruit varieties
- **"Complete Collection"** - Own at least one of every item type

#### Coat and Customization
- **"Coat Collector"** - Create guinea pigs with all available coat types
- **"Diversity Advocate"** - Create guinea pigs of both genders
- **"Name Creator"** - Create 5 guinea pigs with unique names
- **"Heritage Keeper"** - Maintain detailed guinea pig records

#### Store and Economy
- **"Big Spender"** - Spend 1000 total currency in the store
- **"Savvy Shopper"** - Purchase 50 different items
- **"Bargain Hunter"** - Purchase items during limited-time offers
- **"Wealthy Caretaker"** - Accumulate 500 currency at once

### 3. Time-Based Achievements
Recognition for long-term commitment and consistency:

#### Consecutive Play Achievements
- **"Daily Player"** - Play for 7 consecutive days
- **"Weekly Warrior"** - Play for 14 consecutive days
- **"Monthly Master"** - Play for 30 consecutive days
- **"Dedication Champion"** - Play for 60 consecutive days
- **"Year-Long Companion"** - Play for 365 consecutive days

#### Total Time Achievements
- **"First Steps"** - 1 hour of total play time
- **"Getting Started"** - 10 hours of total play time
- **"Committed Caretaker"** - 50 hours of total play time
- **"Guinea Pig Expert"** - 100 hours of total play time
- **"Lifetime Companion"** - 500 hours of total play time

#### Session Achievements
- **"Marathon Player"** - Play for 2 hours in a single session
- **"Quick Check"** - Complete daily care in under 5 minutes
- **"Efficient Caretaker"** - Satisfy all needs in under 10 minutes
- **"Speed Cleaner"** - Clean entire habitat in under 2 minutes

### 4. Special Accomplishments
Recognition for unique milestones and discoveries:

#### Relationship Achievements
- **"First Bond"** - Reach 50% friendship for the first time
- **"Best Friends"** - Reach 75% friendship
- **"Inseparable"** - Reach 100% friendship
- **"Trust Builder"** - Increase friendship by 50 points from lowest point
- **"Relationship Recovery"** - Recover from friendship below 25% to above 75%

#### Discovery Achievements
- **"Preference Detective"** - Discover all food preferences for one guinea pig
- **"Personality Expert"** - Discover all activity preferences
- **"Reaction Collector"** - Witness all positive reactions
- **"Behavior Specialist"** - Observe all autonomous behaviors
- **"Complete Understanding"** - Discover all preferences and reactions

#### Gameplay Mastery
- **"Wellness Expert"** - Maintain 90%+ wellness for 7 days
- **"Interaction Specialist"** - Use every interaction type
- **"Habitat Designer"** - Place 20 different items in habitat
- **"Resource Manager"** - Never run out of bedding for 30 days
- **"Guinea Pig Whisperer"** - Predict guinea pig needs before they become critical

## Achievement Rewards System

### Currency Rewards
Monetary rewards for various achievement tiers:

#### Tier 1 Rewards (Basic Achievements)
- **25-50 currency** for daily care achievements
- **Encourages routine establishment** and basic game engagement
- **Low-barrier rewards** for new players

#### Tier 2 Rewards (Intermediate Achievements)
- **75-150 currency** for weekly milestones and collection achievements
- **Meaningful purchasing power** for habitat improvements
- **Motivation for continued engagement**

#### Tier 3 Rewards (Advanced Achievements)
- **200-500 currency** for major milestones and mastery achievements
- **Significant purchasing power** for premium items
- **Recognition of dedicated play and expertise**

### Special Item Rewards
Exclusive items unlocked through achievements:

#### Cosmetic Rewards
- **Special bedding types** with unique colors or patterns
- **Commemorative habitat decorations** marking major milestones
- **Exclusive coat color unlocks** for future guinea pig creation
- **Trophy items** displaying achievement completion

#### Functional Rewards
- **Premium habitat items** with enhanced effectiveness
- **Efficiency tools** that improve maintenance speed
- **Special treats** with extra happiness bonuses
- **Quality-of-life upgrades** like auto-clean options

### Feature Unlocks
New capabilities gained through achievement completion:

#### Interface Enhancements
- **Advanced statistics dashboard** (after statistics achievements)
- **Habitat customization options** (after collection achievements)
- **Interaction shortcuts** (after interaction mastery achievements)
- **Automated care features** (after consistency achievements)

#### Gameplay Features
- **Multiple guinea pig support** (after mastery achievements)
- **Advanced breeding system** (after expertise achievements)
- **Seasonal event access** (after time-based achievements)
- **Community features** (after social achievements)

## Progress Tracking & Statistics

### Comprehensive Statistics Dashboard
Detailed tracking of all player activities:

#### Care Statistics
- **Total interactions performed** by category and type
- **Friendship level history** with trend analysis
- **Wellness rating averages** over time periods
- **Need satisfaction efficiency** metrics

#### Time and Engagement Statistics
- **Total play time** with session breakdowns
- **Consecutive play days** with streak tracking
- **Daily care completion rates** and timing
- **Average session length** and activity patterns

#### Collection and Economy Statistics
- **Items owned** with acquisition dates
- **Total currency earned** and spending patterns
- **Store purchase history** with preference analysis
- **Resource usage efficiency** tracking

#### Achievement Progress
- **Completion percentages** for each achievement category
- **Progress towards current goals** with time estimates
- **Achievement completion timeline** with milestones
- **Rarity statistics** showing uncommon achievements

## Achievement Notifications & Celebrations

### Notification System
Immediate feedback for achievement completion:

#### In-Game Notifications
- **Pop-up achievement cards** with congratulatory messages
- **Achievement icons** appearing in the activity feed
- **Sound effects** accompanying achievement unlocks
- **Visual celebrations** with particle effects or animations

#### Progress Updates
- **Milestone progress bars** showing advancement toward goals
- **Subtle progress indicators** for near-completion achievements
- **Daily/weekly summary notifications** of progress made
- **Gentle reminders** for achievable milestones

### Celebration Animations
Special visual feedback for major achievements:

#### Achievement Unlock Sequences
- **Confetti or sparkle effects** for major milestones
- **Special guinea pig reactions** celebrating with the player
- **Screen-wide celebration graphics** for rare achievements
- **Custom animation sequences** for the highest-tier accomplishments

#### Social Sharing Integration
- **Achievement sharing capabilities** to social media
- **Screenshot generation** with achievement details
- **Progress sharing** for milestone celebrations
- **Community comparison features** (future enhancement)

## Technical Implementation

### Player Level System Architecture
```typescript
interface PlayerLevelSystem {
  currentLevel: number;
  totalFriendshipPoints: number;
  friendshipToNextLevel: number;
  levelTier: 1 | 2 | 3 | 4 | 5;
  unlockedContent: UnlockedContent;
  levelMilestones: LevelMilestone[];
}

interface UnlockedContent {
  suppliesStoreItems: string[]; // Item IDs unlocked at current level
  cageTypes: CageType[];
  teachableActions: string[]; // Future implementation
  features: string[];
}

interface LevelMilestone {
  level: number;
  tier: number;
  rewards: {
    currency?: number;
    items?: string[];
    features?: string[];
  };
  isReached: boolean;
  reachedDate?: Date;
}

interface CageType {
  id: string;
  name: string;
  size: 'small' | 'medium' | 'large' | 'deluxe';
  capacity: number; // Max guinea pigs
  gridDimensions: { width: number; height: number };
  unlockLevel: number;
  cost: number;
  description: string;
}

// Level calculation based on cumulative friendship
function calculatePlayerLevel(totalFriendship: number): number {
  // Progressive level curve - each level requires more friendship
  // Example: Level 1 = 0-99, Level 2 = 100-249, Level 3 = 250-449, etc.
  const levelThresholds = [0, 100, 250, 450, 700, 1000, 1350, 1750, 2200, 2700];
  // Formula continues scaling for levels 10+

  for (let i = levelThresholds.length - 1; i >= 0; i--) {
    if (totalFriendship >= levelThresholds[i]) {
      return i + 1;
    }
  }
  return 1;
}

// Check if specific content is unlocked
function isContentUnlocked(itemId: string, playerLevel: number): boolean {
  const item = suppliesStore.getItem(itemId);
  return item.requiredLevel <= playerLevel;
}
```

### Cage System Integration
```typescript
// Add to Supplies Store catalog structure
interface SupplyCatalog {
  // ... existing departments
  departments: {
    // ... existing
    cages: {
      name: "Cages & Habitats";
      items: CageSupplyItem[];
    };
  };
}

interface CageSupplyItem extends SupplyItem {
  cageType: CageType;
  currentlyOwned: boolean; // Can only own one cage at a time
  upgradeFrom?: string; // ID of cage this upgrades from
  tradeInValue?: number; // Partial refund when upgrading
}

// Cage upgrade flow
function upgradeCage(newCageId: string): boolean {
  const newCage = suppliesStore.getCageItem(newCageId);
  const currentCage = habitatStore.currentCage;

  if (playerLevel.currentLevel < newCage.unlockLevel) {
    return false; // Not unlocked yet
  }

  // Calculate upgrade cost with trade-in
  const upgradeCost = newCage.cost - (currentCage.tradeInValue || 0);

  if (playerProgression.currency < upgradeCost) {
    return false; // Can't afford
  }

  // Process upgrade
  playerProgression.currency -= upgradeCost;
  habitatStore.setCage(newCageId);

  // Validate existing item placements fit in new dimensions
  habitatStore.validateItemPlacements();

  return true;
}
```

### Achievement Tracking Architecture
```typescript
interface Achievement {
  id: string;
  name: string;
  description: string;
  category: AchievementCategory;
  tier: 1 | 2 | 3;
  requirements: AchievementRequirement[];
  rewards: AchievementReward[];
  isCompleted: boolean;
  completedDate?: Date;
  progress: number; // 0-100 percentage
}

interface AchievementRequirement {
  type: 'count' | 'streak' | 'threshold' | 'collection';
  target: number;
  current: number;
  timeframe?: 'daily' | 'weekly' | 'total';
}

interface AchievementReward {
  type: 'currency' | 'item' | 'feature' | 'level_bonus';
  value: number | string;
  description: string;
}
```

### Progress Tracking System
- **Event-driven tracking** integrated with all game systems
- **Efficient state updates** with batched processing
- **Persistent storage** of all achievement progress
- **Cross-system integration** for comprehensive tracking

### Performance Considerations
- **Lazy evaluation** of achievement progress to minimize overhead
- **Batched updates** for multiple achievements triggered simultaneously
- **Efficient storage** of achievement data with compression
- **Background processing** for complex achievement calculations

## Store Integration

### New Store: Player Progression Store
Central store managing player level, achievement tracking, and progression unlocks:

```typescript
interface PlayerProgressionStore {
  // Level System
  currentLevel: number;
  totalFriendshipPoints: number;
  levelTier: number;
  unlockedContent: UnlockedContent;

  // Achievements
  achievements: Achievement[];
  completedAchievements: Achievement[];
  achievementProgress: Map<string, number>;

  // Methods
  calculateLevel(): void;
  updateFriendshipTotal(): void;
  checkUnlocks(): void;
  unlockAchievement(achievementId: string): void;
  isItemUnlocked(itemId: string): boolean;
  isCageUnlocked(cageId: string): boolean;
}
```

### Store Dependencies
- **Game Controller Store** - Session tracking and timing data
- **Guinea Pig Store** - Friendship tracking for level calculation
- **Needs Controller Store** - Wellness and care statistics for achievements
- **Inventory Store** - Collection tracking for achievements
- **Supplies Store** - Integration for level-locked items and cage upgrades
- **Activity Feed Store** - Event logging for achievement triggers
- **Habitat Store** - Current cage tracking and upgrade processing

### Data Flow Integration
- **Real-time level calculation** - Recalculate when guinea pig friendship changes
- **Achievement evaluation** triggered by game events across all systems
- **Unlock validation** - Supplies Store checks PlayerProgressionStore before purchases
- **Cross-system event coordination** for complex achievements
- **Achievement state persistence** with game save data
- **Achievement notification coordination** with UI systems
- **Cage upgrade validation** - Check level requirements and process trade-ins

## Debug Integration

### Debug Menu Features
- **Level system controls** for testing unlock thresholds
  - Manual level adjustment slider
  - Add friendship points to test level progression
  - View all unlocked content at current level
  - Preview content at higher levels
- **Cage upgrade testing** for validating upgrade flow
  - Force unlock all cage types
  - Test trade-in calculations
  - Validate item placement after cage size changes
- **Achievement unlock controls** for testing reward systems
  - Unlock specific achievements manually
  - Grant achievement rewards (currency, items, features)
- **Progress manipulation** for testing near-completion states
  - Set achievement progress percentages
  - Trigger achievement conditions manually
- **Achievement reset options** for development testing
- **Notification testing** for UI validation
  - Trigger level-up notifications
  - Test unlock notifications for items/cages/features
  - Achievement celebration animations
- **Statistics viewer** for tracking verification
  - View total friendship calculation breakdown
  - See level tier thresholds
  - Track achievement progress across all categories

### Testing Tools
- **Level calculation validation** ensuring friendship totals are accurate
- **Unlock system verification** testing level-gated content access
- **Cage upgrade flow testing** for purchase, trade-in, and item validation
- **Achievement validation** ensuring requirements are achievable
- **Progress calculation verification** for accurate tracking
- **Reward distribution testing** for proper item/currency granting
- **Performance monitoring** for achievement processing overhead

## Future Enhancement Opportunities

### Level System Expansions
- **Prestige levels** beyond level cap with cosmetic rewards
- **Level-based daily bonuses** (currency, free items at login)
- **Friendship multipliers** at high level tiers for faster progression
- **Teachable actions unlock system** - Special interactions available at specific levels
  - Basic tricks (Level 15): Come when called, stand on hind legs
  - Intermediate tricks (Level 25): Navigate obstacle course, fetch small items
  - Advanced tricks (Level 40): Complex routines, synchronized pair behaviors

### Cage System Expansions
- **Themed cage variants** with cosmetic differences (woodland, modern, deluxe)
- **Modular cage additions** - Extensions, second floors, connection tubes
- **Outdoor habitat option** (very high level unlock) with unique mechanics
- **Custom cage decoration themes** unlocked by achievements

### Advanced Achievement Features (Future Phases)
- **Seasonal achievements** tied to holiday events
- **Community challenges** with shared goals
- **Achievement chains** where completing one unlocks others
- **Dynamic achievements** that adapt to player behavior
- **Level-milestone achievements** celebrating progression milestones

### Social Integration Features
- **Leaderboards** for competitive achievement tracking
- **Achievement sharing** with friends and community
- **Collaborative achievements** requiring multiple players
- **Achievement showcases** in player profiles
- **Level badges and titles** displayed in social features

### Gamification Enhancements
- **Achievement points system** with overall scoring
- **Prestige levels** beyond normal progression
- **Rare achievement hunting** with ultra-difficult challenges
- **Achievement collections** with set bonuses for completion
- **Level-based profile customization** unlocking visual prestige elements

This system provides comprehensive recognition for all aspects of guinea pig care while creating meaningful long-term engagement goals that enhance the core gameplay experience. The player level system creates a clear progression pathway tied to the core relationship-building mechanic (friendship), while cage upgrades provide visible, meaningful milestones that improve gameplay capacity and visual prestige.