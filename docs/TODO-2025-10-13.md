# GPS2 Implementation TODO - October 13, 2025

**Created:** October 13, 2025
**Status:** Phase 2 Complete âœ… - Planning Phase 3 ğŸ“‹
**Branch:** GPS2-24
**Previous:** [TODO-2025-10-05.md](archive/TODO-2025-10-05.md)

---

## ğŸ‰ **Phase 2 Complete!**

### System 6.95: Permanent Adoption & Stardust Sanctuary âœ…

All core features implemented and tested:
- âœ… Permanent adoption model (no returns, no sessions)
- âœ… Stardust Sanctuary achievement (85% friendship threshold)
- âœ… Natural store churn (2-5 day adoption timers)
- âœ… Friendship-gated features with 100% wellness freeze
- âœ… Observe interaction with personality glimpses
- âœ… Pet Adoption UI with habitat organization (3-4 per habitat)
- âœ… Paired adoption timers (40% chance, leave together)
- âœ… AdoptionConfirmDialog component
- âœ… InfoButton enhancements and guidance
- âœ… Removed disliked activities and habitats (kept food dislikes)
- âœ… Feeding cycle status panel with manual reset controls

**Documentation:** [System 6.95 Implementation Plan](systems/phase2/system-6.95-REDESIGN-implementation-plan.md)

---

## ğŸ“‹ **On Hold until after Phase 3 - Phase 2.5: Interactive Feedback Enhancement**

### Remaining Phase 2.5 Systems

Phase 2.5 enhances gameplay feedback through personality traits, preferences, wellness-based reactions, rescue system, and comprehensive activity messages. These systems build on Phase 2 foundations to create unique, responsive guinea pig personalities.

**Status:** Systems 1 & 2 Complete, System 2.5 Complete - Testing Phase âœ…

---

#### **System 3: Wellness-Based Interaction Reactions** ğŸ”œ
**Priority:** MEDIUM (uses personality)
**Status:** Not Started

**Goal:** Guinea pigs react differently to interactions based on their wellness level

**Features:**
- Wellness tier system (5 tiers: 80%+, 60-79%, 40-59%, 20-39%, <20%)
- Interaction success rate calculator (95% â†’ 20% based on wellness)
- Behavioral state system (thriving/content/stressed/withdrawn/critical)
- Rejection logic with cooldowns (30-60s)
- Update all interaction methods with wellness checks

**Implementation:**
- Add wellness tier calculation to needsController
- Create behavioral state tracking
- Implement rejection cooldown system
- Update feedGuineaPig, playWithGuineaPig with wellness checks
- Add rejection messages to MessageGenerator

**Files to Update:**
- `src/stores/guineaPigStore.ts` - Add wellness-based reactions
- `src/stores/needsController.ts` - Add behavioral states
- `src/utils/messageGenerator.ts` - Add rejection messages

**Testing Tools:**
- NeedsDebug panel - Adjust wellness/needs to test different tiers
- Activity Feed - Observe interaction success/rejection messages

**Documentation:** [System 3: Wellness-Based Interaction Reactions](systems/phase2.5/system-3-wellness-interaction-reactions.md)

---

#### **System 4: Guinea Pig Rescue System** ğŸ”œ
**Priority:** MEDIUM (uses wellness)
**Status:** Not Started

**Goal:** Emergency intervention when guinea pig wellness drops too low

**Features:**
- Rescue detection system (wellness < 15%)
- Rescue action (restore all needs â†’ 100%, $200 penalty)
- Fresh Start option ($1000 reset, lose purchasable slots 4-10, keep 1-3)
- Rescue modal dialogs
- Warning for guinea pigs in slots 4-10
- Rescue threshold adjustment for testing

**Implementation:**
- Create rescue detection in needsController
- Implement rescue action with currency penalty
- Build Fresh Start with slot reset
- Create RescueDialog and FreshStartDialog components
- Add rescue controls to NeedsDebug panel
- Integrate with Stardust Sanctuary (sanctuary guinea pigs unaffected)

**Files to Update:**
- `src/stores/needsController.ts` - Add rescue detection
- `src/stores/playerProgression.ts` - Add Fresh Start
- `src/components/debug/NeedsDebug.vue` - Add rescue controls

**Files to Create:**
- `src/components/dialogs/RescueDialog.vue`
- `src/components/dialogs/FreshStartDialog.vue`

**Note:** Integration with Stardust Sanctuary documented in [system-4-guinea-pig-rescue.md](systems/phase2.5/system-4-guinea-pig-rescue.md) - sanctuary guinea pigs remain unaffected by rescue

**Documentation:** [System 4: Guinea Pig Rescue](systems/phase2.5/system-4-guinea-pig-rescue.md)

---

#### **System 5: Enhanced Activity Messages** ğŸ”œ
**Priority:** LOW (uses all systems)
**Status:** Not Started

**Goal:** Rich, contextual messages that make the game feel alive

**Features:**
- Need warning system (20-30% warning, <15% critical)
- Throttling system (60s warnings, 30s critical)
- Wellness-based activity messages (4 wellness ranges)
- Like/dislike clue messages (subtle hints about preferences)
- Friendship milestone tracking (6 tiers: 0-10%, 10-30%, 30-50%, 50-70%, 70-85%, 85%+)
- Guinea pig reaction messages to all interactions

**Implementation:**
- Create warning detection in needsController
- Implement message throttling system
- Add wellness-based message templates
- Create preference clue messages
- Implement milestone tracking and notifications
- Update all interaction methods with reaction messages

**Files to Update:**
- `src/stores/needsController.ts` - Add warning system
- `src/stores/activityFeed.ts` - Add message categories
- `src/utils/messageGenerator.ts` - Add new templates

**Testing Tools:**
- Activity Feed - Observe message throttling, reactions, warnings
- NeedsDebug panel - Test different wellness levels

**Documentation:** [System 5: Enhanced Activity Messages](systems/phase2.5/system-5-enhanced-activity-messages.md)

---

## ğŸ“‹ **Next Steps - Phase 3: Habitat & Environment**

**Status:** System 13 Foundation Complete âœ… - Restructuring Phase 3 Order ğŸ“‹

### Phase 3 Architecture Update (October 14, 2025)

Phase 3 has been restructured to follow proper dependency flow: **Supplies Store â†’ Inventory Management â†’ Habitat Integration**

This approach establishes the proper data architecture where:
1. **Supplies Store** defines all purchasable items (catalog, pricing, metadata)
2. **Inventory System** tracks owned items and quantities
3. **Habitat Conditions** consumes inventory resources
4. **Habitat Items** uses inventory for placement
5. **Maintenance** affects conditions and consumes resources

**Updated Documentation:**
- âœ… [DEVELOPMENT_PHASES.md](DEVELOPMENT_PHASES.md) - Phase 3 restructured (Systems 11-15)
- âœ… [PROJECT_PLAN.md](PROJECT_PLAN.md) - Phase 3 references updated
- âœ… [SYSTEM_INTEGRATION.md](SYSTEM_INTEGRATION.md) - Supplies & Inventory dependencies added

---

### Priority Systems for Phase 3 (Restructured Order)

#### **System 11: Supplies Store System** âœ… **COMPLETED**
**Priority:** HIGH (foundation for all Phase 3 systems)
**Status:** âœ… **Completed** (October 15, 2025 | Branch: GPS2-26, GPS2-27)

**Goal:** Central catalog of all purchasable items in the game

**Completed Features:**
- âœ… **Bedding types** (cheap, average, premium) with absorbency/decay rates, color varieties
- âœ… **Hay varieties** (8 types: Timothy, Orchard Grass, Alfalfa, Meadow, Oat, Botanical, Wheat, Mixed) with nutritional profiles
- âœ… **Food items** organized by 6 subcategories:
  - Fresh Greens (5 items)
  - Fresh Herbs (4 items)
  - Vegetables (7 items)
  - Fruits (6 items)
  - Pellets (3 tiers: Cheap, Standard, Fortified)
  - Premium Treats (3 items with visual effects & badge unlocks)
- âœ… **Habitat items** (64+ items across 5 subcategories):
  - Hideaways (13): Basic, Tunnels, Premium, Beds
  - Toys (11): Rolling, Interactive, Premium
  - Chews (12): Natural Wood, Shaped, Premium
  - Bowls & Bottles (12): Water bottles, Food bowls, Hay racks
  - Enrichment (16): Platforms, Exploration, Sensory, Premium
- âœ… **Item metadata** (name, description, price, category, stats, quality, tags)
- âœ… **Availability system** (always, seasonal, limited)
- âœ… **Purchase flow integration** (currency deduction, inventory addition)
- âœ… **Reusable SupplyItemCard component** with quantity selector and purchase controls
- âœ… **Sell-back system** (100% refund for unopened/unplaced items)
- âœ… **Starter inventory** (6 essential items given on first guinea pig adoption)

**Total Items:** 104+ unique purchasable items

**Files Created:**
- âœ… `src/stores/suppliesStore.ts` - Main supplies catalog store with 104+ items
- âœ… `src/types/supplies.ts` - TypeScript interfaces for items, inventory, cart, purchase, sell-back
- âœ… `src/stores/inventoryStore.ts` - Instance-based inventory with sell-back restrictions
- âœ… `src/components/debug/SuppliesStoreDebug.vue` - Supplies store debug panel with sell-back UI
- âœ… `src/components/debug/SupplyItemCard.vue` - Reusable item card with sell/buy controls
- âœ… `src/components/debug/InventoryDebug.vue` - Three-column grid inventory display

**Integration Points:**
- âœ… Player Progression (currency for purchases) - Integrated
- âœ… Inventory Store (purchase flow, ownership tracking) - Implemented
- âœ… Pet Store Manager (starter inventory on first adoption) - Integrated
- â†’ Habitat Conditions (bedding/hay consumption) - Ready for integration
- â†’ Needs Controller (food consumption) - Ready for integration

**Documentation:** [System 11: Supplies Store](systems/phase3/system-11-supplies-store.md)

---

#### **System 12: Inventory Management System** âœ… **COMPLETED**
**Priority:** HIGH (depends on Supplies Store)
**Status:** âœ… **Completed** (October 16, 2025 | Branch: GPS2-27)

**Goal:** Track owned items, quantities, and consumption across all game systems

**Completed Features:**
- âœ… **Instance-based tracking** - Each item is a unique instance with individual state
- âœ… **Item state tracking** - Track opened/unopened bags, placed/unplaced habitat items
- âœ… **Sell-back system** - 100% refund for returnable items with restrictions:
  - Cannot return opened bags of hay or bedding
  - Cannot return items placed in habitat
  - Otherwise items can be sold back for full price
- âœ… **Category organization** - Consumables (bedding, hay, food) and Habitat Items
- âœ… **Starter inventory** - New players receive 6 essential items on first adoption:
  - 1Ã— Timothy Hay
  - 1Ã— Average Bedding
  - 1Ã— Standard Pellets
  - 1Ã— Green Leaf Lettuce
  - 1Ã— Carrot
  - 1Ã— Apple Wood Sticks
- âœ… **Debug controls** - Mark items as opened/placed for testing sell-back restrictions
- âœ… **Data migration** - Automatic migration from old quantity-based to instance-based format
- âœ… **Three-column responsive grid** - Mobile-first design (1/2/3 columns)
- âœ… **Inventory card design** - Gradient backgrounds, distinct from store cards
- âœ… **Navigation organization** - Inventory moved to Environment Systems dropdown

**Instance-Based System:**
- Each item has unique `instanceId` for individual tracking
- Separate counts for opened/unopened, placed/unplaced items
- "Open One" button marks single instance as opened
- "Place One" / "Remove One" buttons for habitat item placement
- Returnable quantity shows items eligible for sell-back

**Files Completed:**
- âœ… `src/stores/inventoryStore.ts` - Full instance-based implementation
- âœ… `src/types/supplies.ts` - ItemInstance interface with state tracking
- âœ… `src/components/debug/InventoryDebug.vue` - Redesigned with grid layout
- âœ… `src/components/debug/SupplyItemCard.vue` - Sell-back UI integration
- âœ… `src/stores/petStoreManager.ts` - Starter inventory integration

**Integration Points:**
- âœ… Supplies Store (item catalog, pricing) - Fully integrated
- âœ… Player Progression (currency for sell-back refunds) - Integrated
- âœ… Pet Store Manager (starter inventory on adoption) - Integrated
- âœ… Habitat Conditions (bedding/hay consumption) - Fully integrated
- âœ… Habitat Item System (placement tracking) - Fully integrated
- â†’ Needs Controller (food consumption) - Ready for integration

---

#### **System 13: Habitat Conditions Store** âœ… **COMPLETED**
**Priority:** HIGH (fully integrated with Supplies & Inventory)
**Status:** âœ… **Completed** (October 16, 2025 | Branch: GPS2-27)

**Goal:** Environmental condition tracking consuming inventory resources

**Completed Features:**
- âœ… Cleanliness tracking (0-100%, decay over time)
- âœ… Bedding freshness (quality-based: cheap/average/premium with absorbency/decay from Supplies Store)
- âœ… Hay freshness (bag tracking with 20 handfuls per bag, auto-refill from inventory)
- âœ… Water level (0-100%, refill system)
- âœ… Resource management actions (clean cage, refresh bedding, refill hay, refill water, give hay handful)
- âœ… Condition history tracking
- âœ… Reset to 100% on new game session
- âœ… **Habitat Items Tracking** - Track items placed IN habitat separately from inventory
- âœ… **Starter Habitat Items** - 4 items placed in habitat on first adoption (water bottle, igloo, bowl, hay rack)
- âœ… **Migration-free implementation** - Removed all backward compatibility code

**HabitatDebug Panel Features:**
- âœ… No guinea pigs warning pattern
- âœ… Full-width Habitat Conditions panel with integrated controls
- âœ… Bedding/Hay type selects integrated directly into condition items
- âœ… Dynamic condition summary with themed gradients (green/yellow/red based on overall condition)
- âœ… Smart hay handful system (auto-opens new bag when current bag is empty)
- âœ… Stock count display in select option labels
- âœ… **Habitat Items Panel (FPO)** - Grid display of items currently in habitat
- âœ… **Move to Inventory** - Remove items from habitat back to inventory

**Supplies Store Integration:**
- âœ… Bedding metadata pulled from Supplies Store (absorbency, decay rate)
- âœ… Hay metadata pulled from Supplies Store (8 types available)
- âœ… Habitat items metadata (water bottles, bowls, igloo, hay rack)
- âœ… All item stats sourced from central catalog

**Inventory Integration:**
- âœ… Real consumption depletes inventory (marks items as opened/used)
- âœ… Bedding refresh consumes 1 bedding bag from inventory
- âœ… Hay refill consumes 1 hay bag from inventory (gives 20 handfuls)
- âœ… Handful of hay consumes from current bag (auto-opens new bag if needed)
- âœ… Habitat items marked as "placed" when added to habitat
- âœ… Habitat items unmarked when moved back to inventory

**Habitat Items System:**
- âœ… `habitatItems` ref tracking items currently placed in habitat
- âœ… `addItemToHabitat()` - Move item from inventory to habitat
- âœ… `removeItemFromHabitat()` - Move item from habitat back to inventory
- âœ… `initializeStarterHabitat()` - Set up starter items on first adoption
- âœ… Integration with `markAsPlacedInHabitat()` / `unmarkAsPlacedInHabitat()` in inventory store

**Starter Habitat Setup:**
- âœ… **In Habitat (4 items placed):**
  - Basic Water Bottle
  - Plastic Igloo
  - Basic Ceramic Bowl
  - Basic Hay Rack
- âœ… **In Inventory Only (6 items):**
  - Timothy Hay (unopened bag)
  - Average Bedding (unopened bag)
  - Standard Pellets
  - Green Leaf Lettuce
  - Carrot
  - Apple Wood Sticks

**Files Completed:**
- âœ… `src/stores/habitatConditions.ts` - Full integration with Supplies & Inventory
- âœ… `src/components/debug/HabitatDebug.vue` - Complete UI with Habitat Items panel
- âœ… `src/stores/suppliesStore.ts` - Added `habitat_basic_water_bottle` item
- âœ… `src/stores/petStoreManager.ts` - Starter habitat items integration
- âœ… `src/stores/inventoryStore.ts` - Habitat placement tracking

**Documentation:** [System 13: Habitat Conditions](systems/phase3/system-13-habitat-conditions.md)

---

#### **System 14: Habitat Item System** ğŸ”œ
**Goal:** Physical items guinea pigs interact with, placed from inventory

**Items:**
- Hideaways (igloos, tunnels, tents)
- Food bowls and water bottles
- Toys (tunnels, balls, chew toys)
- Enrichment items

**Implementation:**
- Item placement system using Inventory data
- Placement and interaction system
- Preference-based item usage
- Item condition decay

**Integration Points:**
- â† Inventory Store (placed items must be owned)
- â† Supplies Store (item stats and metadata)

---

#### **System 15: Habitat Maintenance & Hygiene System** ğŸ”œ
**Goal:** Regular care and cleaning tasks affecting habitat conditions

**Tasks:**
- Spot cleaning (remove waste)
- Deep cleaning (full habitat clean)
- Bedding changes
- Water bottle refills
- Food bowl restocking

**Implementation:**
- Task scheduling system
- Visual dirt/mess indicators
- Impact on Habitat Conditions (cleanliness, bedding freshness)
- Time-based task completion

**Integration Points:**
- â†’ Habitat Conditions Store (affects cleanliness, freshness)
- â†’ Inventory Store (consumes cleaning supplies)

---

## ğŸ¯ **High Priority Improvements**

### Friendship System Redesign ğŸ”¥
**Priority:** HIGH (affects progression and sanctuary system)
**Goal:** Change friendship from percentage-based (0-100%) to infinite point-based progression

**Current System Issues:**
- Friendship is capped at 100%, limiting long-term progression
- Stardust Sanctuary uses 85% threshold, which feels arbitrary
- No incentive to continue building friendship after 100%

**New System Design:**
- **Point-Based Friendship:** Infinite points earned through interactions
- **Friendship Levels:** Tiered system (levels 1-10+) based on point thresholds
  - Level 1: 0-100 points
  - Level 2: 101-250 points
  - Level 3: 251-500 points
  - Level 4: 501-850 points â† **Stardust Sanctuary unlocks at Level 4**
  - Level 5+: Increasing thresholds (1200, 1800, 2500, 3500, 5000, 7500+)
- **Visual Display:** Show current level + progress bar to next level
- **Stardust Sanctuary:** Unlock at Level 4 (equivalent to current 85% threshold)

**Implementation:**
- Update `GuineaPig` interface to replace `friendship: number` (0-100) with `friendshipPoints: number` and `friendshipLevel: number`
- Create friendship level calculation function
- Update all friendship gain/loss to add/subtract points instead of percentages
- Update Stardust Sanctuary condition check (level >= 4 instead of >= 85%)
- Update UI displays to show level + progress bar
- Migrate existing friendship percentages to point equivalents (% * 10 = starting points)

**Files to Update:**
- `src/types/guineaPig.ts` - Update interface
- `src/stores/guineaPigStore.ts` - Update friendship logic
- `src/stores/petStoreManager.ts` - Update sanctuary check (level >= 4)
- `src/components/debug/GuineaPigEditor.vue` - Update friendship controls
- All components displaying friendship (show level instead of %)

**Backward Compatibility:**
- Migration function to convert existing friendship % â†’ points (multiply by 10)
- Store persistence will handle conversion on load

---

### Port Real Food Items to Guinea Pig Preferences ğŸ”¥
**Priority:** HIGH (depends on Supplies Store completion)
**Goal:** Replace hardcoded food lists with actual items from Supplies Store catalog

**Current System Issues:**
- Food preferences use hardcoded arrays (`petStoreManager.vegetables`, `petStoreManager.fruits`, etc.)
- No connection to actual purchasable food items
- Disconnect between what can be bought and what guinea pigs prefer

**New System Design:**
- **After Supplies Store is built:** Update Guinea Pig Editor to use real food items
- Pull food lists from `suppliesStore` instead of `petStoreManager`
- Categories to port:
  - Fresh Greens (5 items)
  - Fresh Herbs (4 items)
  - Vegetables (5-7 items)
  - Fruits (5-6 items)
  - Pellets (3 tiers)
  - Premium Treats (3 items) - Special consideration for favorites

**Implementation:**
- Update `GuineaPigEditor.vue` to source food from `suppliesStore.getFoodByCategory()`
- Update preference generation in `petStoreManager` to use Supplies Store catalog
- Ensure favorite/disliked food IDs match Supplies Store item IDs
- Update feeding system to cross-reference Supplies Store for food stats

**Files to Update:**
- `src/components/debug/GuineaPigEditor.vue` - Update food selection dropdowns
- `src/stores/petStoreManager.ts` - Update preference generation to use Supplies Store
- `src/stores/guineaPigStore.ts` - Validate food IDs against Supplies Store

**Dependencies:**
- âœ… Must complete System 11: Supplies Store first
- â³ Requires `suppliesStore.ts` with full food catalog

**Testing:**
- Verify all existing guinea pigs' food preferences map to real items
- Test generating new guinea pigs with Supplies Store food items
- Ensure feeding system recognizes all food items

---

### Personality-Based Habitat Sensitivity (New Trait) ğŸ”¥
**Priority:** MEDIUM (enhances Phase 3 Habitat Systems)
**Goal:** Add 5th personality trait affecting guinea pig tolerance to habitat conditions

**New Cleanliness Personality Trait (1-10):**

**Picky/Particular (High Cleanliness 7-10):**
- **Finicky about freshness** - Reduced tolerance for stale hay, old bedding, dirty habitat
- **Higher standards** - Comfort need decays faster when habitat conditions drop below 60%
- **Hay freshness threshold** - Won't eat hay below 60% freshness (vs 40% baseline)
- **Bedding sensitivity** - Bedding freshness below 50% causes comfort penalties
- **Cleanliness stress** - Cage cleanliness below 50% causes anxiety (-5 to -10 comfort/hour)
- **Activity messages:**
  - "Guinea pig wrinkles nose at the stale hay"
  - "Guinea pig seems uncomfortable with the messy cage"
  - "Guinea pig appreciates the fresh, clean habitat!"

**Piggy/Unbothered (Low Cleanliness 1-3):**
- **Tolerant of mess** - Will eat hay down to 20% freshness (vs 40% baseline)
- **Unfazed by dirt** - Comfort need unaffected until cleanliness drops below 30%
- **Not picky** - Bedding freshness doesn't impact comfort until below 25%
- **Easy-going** - No stress penalties from habitat conditions unless critical (< 20%)
- **Activity messages:**
  - "Guinea pig happily munches the hay without concern"
  - "Guinea pig doesn't seem bothered by the messy cage"
  - "Guinea pig is content in any conditions"

**Moderate Cleanliness (4-6):**
- **Baseline behavior** - Standard thresholds (40% hay, 40% bedding, 40% cleanliness)
- **Balanced tolerance** - Neither finicky nor unbothered

**Cleanliness Modifiers:**
```typescript
// Hay freshness eating threshold
hayFreshnessThreshold = {
  picky (7-10): 60%      // Won't eat below this
  moderate (4-6): 40%    // Baseline
  piggy (1-3): 20%       // Very tolerant
}

// Comfort penalty from poor cleanliness
if (cleanliness < cleanlinessThreshold) {
  const cleanlinessPersonality = guineaPig.personality.cleanliness
  if (cleanlinessPersonality >= 7) {
    // Picky: starts penalties at 50%, severe at 30%
    comfortPenalty = (50 - cleanliness) * 0.3
  } else if (cleanlinessPersonality <= 3) {
    // Piggy: only penalized below 30%, mild penalties
    comfortPenalty = cleanliness < 30 ? (30 - cleanliness) * 0.1 : 0
  } else {
    // Moderate: baseline penalties starting at 40%
    comfortPenalty = (40 - cleanliness) * 0.2
  }
}

// Bedding freshness comfort impact
if (beddingFreshness < beddingThreshold) {
  if (cleanlinessPersonality >= 7) {
    // Picky: uncomfortable with bedding < 50%
    beddingPenalty = (50 - beddingFreshness) * 0.2
  } else if (cleanlinessPersonality <= 3) {
    // Piggy: only cares below 25%
    beddingPenalty = beddingFreshness < 25 ? (25 - beddingFreshness) * 0.1 : 0
  }
}
```

**Implementation:**
- Add `cleanliness: number` (1-10) to `Personality` interface in `guineaPig.ts`
- Update guinea pig generation to include cleanliness trait (random 1-10)
- Implement threshold calculation functions in `habitatConditions.ts`
- Add comfort penalty calculations based on cleanliness personality
- Update hay eating logic to check freshness thresholds
- Add cleanliness-specific activity messages to `messageGenerator.ts`

**Debug Panel Display:**
- **Cleanliness Trait Slider** - Adjust 1-10 for testing
- **Current Thresholds Display** - Show active hay/bedding/cleanliness thresholds based on personality
- **Penalty Visualization** - Real-time comfort penalties from habitat conditions
- **Personality Type Label:**
  - "Picky Princess" (9-10)
  - "Particular Pig" (7-8)
  - "Balanced" (4-6)
  - "Easy-Going" (2-3)
  - "Total Piggy" (1)

**Files to Update:**
- `src/types/guineaPig.ts` - Add cleanliness to Personality interface
- `src/stores/guineaPigStore.ts` - Generate cleanliness trait
- `src/stores/habitatConditions.ts` - Implement threshold/penalty logic
- `src/stores/needsController.ts` - Apply comfort penalties
- `src/utils/messageGenerator.ts` - Add cleanliness-specific messages
- `src/components/debug/GuineaPigEditor.vue` - Add cleanliness slider
- `src/components/debug/HabitatDebug.vue` - Display thresholds and penalties

**Integration Points:**
- â†’ Habitat Conditions (thresholds for hay/bedding/cleanliness)
- â†’ Needs Controller (comfort penalties)
- â†’ Activity Feed (cleanliness-specific messages)
- â†’ Guinea Pig Editor (trait editing)

**Documentation:** [Habitat Debug Development Plan - Phase 3](systems/phase3/habitat-debug-development-plan.md#personality-based-habitat-sensitivity-new-trait)

---

### Feeding System Realism Enhancement ğŸ”¥
**Priority:** MEDIUM
**Goal:** Add realistic eating behaviors with timing and partial consumption

**Features to Add:**
- **Eating Duration:** Different foods take different times to eat
  - Hay: 10+ seconds (grazing behavior), may leave leftovers
  - Leafy greens (lettuce, kale): 5-8 seconds, partial eating/grazing
  - Crunchy vegetables (carrot, pepper): 8-12 seconds, may nibble and leave
  - Fruits: 3-5 seconds, consumed completely
  - Treats: 2-3 seconds, consumed completely
  - Pellets: 5-8 seconds, consumed completely

- **Partial Consumption:**
  - Hay: Guinea pig may eat 30-70% and leave rest
  - Leafy vegetables: May eat 50-100% depending on preference
  - Root vegetables: May nibble and return multiple times
  - Track "leftover food" that can be eaten later

- **Eating Animations/Status:**
  - Show "Eating [food]..." status during consumption
  - Visual feedback in activity feed with progress
  - Eating sound/behavior indicators

- **Realistic Feeding Mechanics:**
  - Guinea pigs don't eat if not hungry enough (< 30% hunger?)
  - Favorite foods more likely to be eaten completely
  - Disliked foods may be rejected or partially eaten
  - Multiple guinea pigs can eat at the same time

**Implementation Notes:**
- Add `eatingState` to guinea pig (food being eaten, start time, duration)
- Create eating timer system in needsController
- Update feedGuineaPig to start eating timer instead of instant satisfaction
- Add eating completion callback to apply hunger satisfaction
- Track partial food items in habitat/inventory
- Create "Eating Status" display in debug panels

**Files to Update:**
- `src/stores/guineaPigStore.ts` - Add eating state tracking
- `src/stores/needsController.ts` - Add eating timer logic
- `src/components/debug/FeedingDebug.vue` - Show eating status
- `src/utils/messageGenerator.ts` - Add eating progress messages

---

## ğŸ”§ **Technical Debt & Polish**

### Code Cleanup
- [x] Review and consolidate debug panel styles
- [x] Audit unused imports across components
- [x] Remove any remaining legacy favorites references in comments
- [ ] Standardize error handling patterns

### UI/UX Improvements
- [ ] Add loading states for long operations
- [ ] Improve mobile responsiveness for debug panels
- [ ] Add keyboard shortcuts for common debug actions
- [x] Enhance visual feedback for disabled buttons

### Documentation
- [x] Update architecture diagrams for Phase 2 changes
- [x] Document state management patterns
- [ ] Create component library reference
- [ ] Add inline JSDoc comments for complex functions

---

## ğŸ“ **Notes**

### Recent Changes (Phase 7 - October 13)
- Changed "Cage" terminology to "Habitat" throughout Pet Adoption UI
- Changed "Pet Store" to "Pet Adoption" in main heading
- Added InfoButton to Stardust Sanctuary with feature description
- Increased InfoButton popover width (300px default, 400px max)
- Added Feeding Cycle Status panel showing hunger progress and manual reset controls
- Removed disliked activities and habitats from preference system (kept food dislikes)
- Updated all affected components, stores, and message generators

### Property Name Considerations
Note: `cageNumber` property name remains in code for data compatibility, only UI labels use "habitat"

### System Integration
All Phase 2 systems are fully integrated:
- Friendship system with passive gain/loss
- Needs system with personality modifiers
- Preferences with food/activity favorites
- Consumption limits with hunger cycles
- Stardust Sanctuary with 85% threshold
- Permanent adoption with natural churn

---

## ğŸ® **Testing Checklist**

### Pre-Phase 3 Testing
- [ ] Test full adoption flow with observe interaction
- [ ] Verify paired guinea pigs leave store together
- [ ] Test Stardust Sanctuary unlock at 85% friendship
- [ ] Verify consumption limits reset at 100% hunger
- [ ] Test preference system (favorites, dislikes, rejection)
- [ ] Verify habitat grouping displays correctly
- [ ] Test InfoButton tooltips across all panels

### Integration Testing
- [ ] Test multiple guinea pigs with different personalities
- [ ] Verify friendship gain/loss calculations
- [ ] Test edge cases (0% friendship, 100% friendship)
- [ ] Verify adoption timer expiration and store updates
- [ ] Test manual consumption limit resets

---

## ğŸš€ **Commands**

**Development:**
- `npm run dev` - Start development server
- `npm run build` - Production build (run before commits)
- `npm run preview` - Preview production build

**Git:**
- Current branch: `GPS2-24`
- Main branch: `main`

---

## ğŸ“š **Documentation Links**

- [Project Plan](PROJECT_PLAN.md)
- [Development Phases](DEVELOPMENT_PHASES.md)
- [System Integration](SYSTEM_INTEGRATION.md)
- [Phase 2 Systems](systems/phase2/)
- [Phase 2.5 Systems](systems/phase2.5/)
- [System 6.95 Implementation](systems/phase2/system-6.95-REDESIGN-implementation-plan.md)
