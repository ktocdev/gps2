# GPS2 Implementation TODO - October 13, 2025

**Created:** October 13, 2025
**Status:** Phase 2 Complete ✅ - Planning Phase 3 📋
**Branch:** GPS2-24
**Previous:** [TODO-2025-10-05.md](archive/TODO-2025-10-05.md)

---

## 🎉 **Phase 2 Complete!**

### System 6.95: Permanent Adoption & Stardust Sanctuary ✅

All core features implemented and tested:
- ✅ Permanent adoption model (no returns, no sessions)
- ✅ Stardust Sanctuary achievement (85% friendship threshold)
- ✅ Natural store churn (2-5 day adoption timers)
- ✅ Friendship-gated features with 100% wellness freeze
- ✅ Observe interaction with personality glimpses
- ✅ Pet Adoption UI with habitat organization (3-4 per habitat)
- ✅ Paired adoption timers (40% chance, leave together)
- ✅ AdoptionConfirmDialog component
- ✅ InfoButton enhancements and guidance
- ✅ Removed disliked activities and habitats (kept food dislikes)
- ✅ Feeding cycle status panel with manual reset controls

**Documentation:** [System 6.95 Implementation Plan](systems/phase2/system-6.95-REDESIGN-implementation-plan.md)

---

## 📋 **Next Steps - Phase 2.5: Interactive Feedback Enhancement**

### Remaining Phase 2.5 Systems

Phase 2.5 enhances gameplay feedback through personality traits, preferences, wellness-based reactions, rescue system, and comprehensive activity messages. These systems build on Phase 2 foundations to create unique, responsive guinea pig personalities.

**Status:** Systems 1 & 2 Complete, System 2.5 Complete - Testing Phase ✅

---

#### **System 3: Wellness-Based Interaction Reactions** 🔜
**Priority:** MEDIUM (uses personality)
**Status:** Not Started

**Goal:** Guinea pigs react differently to interactions based on their wellness level

**Features:**
- Wellness tier system (5 tiers: 80%+, 60-79%, 40-59%, 20-39%, <20%)
- Interaction success rate calculator (95% → 20% based on wellness)
- Behavioral state system (thriving/content/stressed/withdrawn/critical)
- Rejection logic with cooldowns (30-60s)
- Update all interaction methods with wellness checks

**Implementation:**
- Add wellness tier calculation to needsController
- Create behavioral state tracking
- Implement rejection cooldown system
- Update feedGuineaPig, playWithGuineaPig with wellness checks
- Add rejection messages to MessageGenerator

**Files to Update:**
- `src/stores/guineaPigStore.ts` - Add wellness-based reactions
- `src/stores/needsController.ts` - Add behavioral states
- `src/utils/messageGenerator.ts` - Add rejection messages

**Testing Tools:**
- NeedsDebug panel - Adjust wellness/needs to test different tiers
- Activity Feed - Observe interaction success/rejection messages

**Documentation:** [System 3: Wellness-Based Interaction Reactions](systems/phase2.5/system-3-wellness-interaction-reactions.md)

---

#### **System 4: Guinea Pig Rescue System** 🔜
**Priority:** MEDIUM (uses wellness)
**Status:** Not Started

**Goal:** Emergency intervention when guinea pig wellness drops too low

**Features:**
- Rescue detection system (wellness < 15%)
- Rescue action (restore all needs → 100%, $200 penalty)
- Fresh Start option ($1000 reset, lose purchasable slots 4-10, keep 1-3)
- Rescue modal dialogs
- Warning for guinea pigs in slots 4-10
- Rescue threshold adjustment for testing

**Implementation:**
- Create rescue detection in needsController
- Implement rescue action with currency penalty
- Build Fresh Start with slot reset
- Create RescueDialog and FreshStartDialog components
- Add rescue controls to NeedsDebug panel
- Integrate with Stardust Sanctuary (sanctuary guinea pigs unaffected)

**Files to Update:**
- `src/stores/needsController.ts` - Add rescue detection
- `src/stores/playerProgression.ts` - Add Fresh Start
- `src/components/debug/NeedsDebug.vue` - Add rescue controls

**Files to Create:**
- `src/components/dialogs/RescueDialog.vue`
- `src/components/dialogs/FreshStartDialog.vue`

**Note:** Integration with Stardust Sanctuary documented in [system-4-guinea-pig-rescue.md](systems/phase2.5/system-4-guinea-pig-rescue.md) - sanctuary guinea pigs remain unaffected by rescue

**Documentation:** [System 4: Guinea Pig Rescue](systems/phase2.5/system-4-guinea-pig-rescue.md)

---

#### **System 5: Enhanced Activity Messages** 🔜
**Priority:** LOW (uses all systems)
**Status:** Not Started

**Goal:** Rich, contextual messages that make the game feel alive

**Features:**
- Need warning system (20-30% warning, <15% critical)
- Throttling system (60s warnings, 30s critical)
- Wellness-based activity messages (4 wellness ranges)
- Like/dislike clue messages (subtle hints about preferences)
- Friendship milestone tracking (6 tiers: 0-10%, 10-30%, 30-50%, 50-70%, 70-85%, 85%+)
- Guinea pig reaction messages to all interactions

**Implementation:**
- Create warning detection in needsController
- Implement message throttling system
- Add wellness-based message templates
- Create preference clue messages
- Implement milestone tracking and notifications
- Update all interaction methods with reaction messages

**Files to Update:**
- `src/stores/needsController.ts` - Add warning system
- `src/stores/activityFeed.ts` - Add message categories
- `src/utils/messageGenerator.ts` - Add new templates

**Testing Tools:**
- Activity Feed - Observe message throttling, reactions, warnings
- NeedsDebug panel - Test different wellness levels

**Documentation:** [System 5: Enhanced Activity Messages](systems/phase2.5/system-5-enhanced-activity-messages.md)

---

## 📋 **Next Steps - Phase 3: Habitat & Environment**

### Priority Systems for Phase 3

#### **System 11: Habitat Conditions** 🔜
**Goal:** Dynamic habitat environment affecting guinea pig wellness

**Features:**
- Temperature monitoring (ideal: 65-75°F, alerts above 80°F)
- Humidity tracking (ideal: 30-70%)
- Cleanliness level (0-100%, affects comfort and health)
- Habitat size and space per guinea pig
- Seasonal weather effects

**Implementation:**
- Add habitat conditions to gameController
- Create condition decay over time
- Implement comfort/health impacts
- Build HabitatConditions debug panel

#### **System 12: Habitat Items** 🔜
**Goal:** Physical items guinea pigs interact with

**Items:**
- Hideaways (igloos, tunnels, tents)
- Food bowls and water bottles
- Toys (tunnels, balls, chew toys)
- Bedding types (fleece, paper, aspen)
- Enrichment items

**Implementation:**
- Item data structure with durability
- Placement and interaction system
- Preference-based item usage
- Item condition decay

#### **System 13: Inventory & Store** 🔜
**Goal:** Player inventory and shopping system

**Features:**
- Food inventory (vegetables, fruits, hay, pellets, treats)
- Item inventory (hideaways, toys, bedding)
- Store interface for purchasing supplies
- Cost balancing with currency system
- Quantity tracking and depletion

#### **System 14: Habitat Maintenance** 🔜
**Goal:** Regular care and cleaning tasks

**Tasks:**
- Spot cleaning (remove waste)
- Deep cleaning (full cage clean)
- Bedding changes
- Water bottle refills
- Food bowl restocking

**Implementation:**
- Task scheduling system
- Visual dirt/mess indicators
- Impact on cleanliness condition
- Time-based task completion

---

## 🎯 **High Priority Improvements**

### Feeding System Realism Enhancement 🔥
**Goal:** Add realistic eating behaviors with timing and partial consumption

**Features to Add:**
- **Eating Duration:** Different foods take different times to eat
  - Hay: 10+ seconds (grazing behavior), may leave leftovers
  - Leafy greens (lettuce, kale): 5-8 seconds, partial eating/grazing
  - Crunchy vegetables (carrot, pepper): 8-12 seconds, may nibble and leave
  - Fruits: 3-5 seconds, consumed completely
  - Treats: 2-3 seconds, consumed completely
  - Pellets: 5-8 seconds, consumed completely

- **Partial Consumption:**
  - Hay: Guinea pig may eat 30-70% and leave rest
  - Leafy vegetables: May eat 50-100% depending on preference
  - Root vegetables: May nibble and return multiple times
  - Track "leftover food" that can be eaten later

- **Eating Animations/Status:**
  - Show "Eating [food]..." status during consumption
  - Visual feedback in activity feed with progress
  - Eating sound/behavior indicators

- **Realistic Feeding Mechanics:**
  - Guinea pigs don't eat if not hungry enough (< 30% hunger?)
  - Favorite foods more likely to be eaten completely
  - Disliked foods may be rejected or partially eaten
  - Multiple guinea pigs can eat at the same time

**Implementation Notes:**
- Add `eatingState` to guinea pig (food being eaten, start time, duration)
- Create eating timer system in needsController
- Update feedGuineaPig to start eating timer instead of instant satisfaction
- Add eating completion callback to apply hunger satisfaction
- Track partial food items in habitat/inventory
- Create "Eating Status" display in debug panels

**Files to Update:**
- `src/stores/guineaPigStore.ts` - Add eating state tracking
- `src/stores/needsController.ts` - Add eating timer logic
- `src/components/debug/FeedingDebug.vue` - Show eating status
- `src/utils/messageGenerator.ts` - Add eating progress messages

---

## 🔧 **Technical Debt & Polish**

### Code Cleanup
- [x] Review and consolidate debug panel styles
- [x] Audit unused imports across components
- [x] Remove any remaining legacy favorites references in comments
- [ ] Standardize error handling patterns

### UI/UX Improvements
- [ ] Add loading states for long operations
- [ ] Improve mobile responsiveness for debug panels
- [ ] Add keyboard shortcuts for common debug actions
- [x] Enhance visual feedback for disabled buttons

### Documentation
- [x] Update architecture diagrams for Phase 2 changes
- [x] Document state management patterns
- [ ] Create component library reference
- [ ] Add inline JSDoc comments for complex functions

---

## 📝 **Notes**

### Recent Changes (Phase 7 - October 13)
- Changed "Cage" terminology to "Habitat" throughout Pet Adoption UI
- Changed "Pet Store" to "Pet Adoption" in main heading
- Added InfoButton to Stardust Sanctuary with feature description
- Increased InfoButton popover width (300px default, 400px max)
- Added Feeding Cycle Status panel showing hunger progress and manual reset controls
- Removed disliked activities and habitats from preference system (kept food dislikes)
- Updated all affected components, stores, and message generators

### Property Name Considerations
Note: `cageNumber` property name remains in code for data compatibility, only UI labels use "habitat"

### System Integration
All Phase 2 systems are fully integrated:
- Friendship system with passive gain/loss
- Needs system with personality modifiers
- Preferences with food/activity favorites
- Consumption limits with hunger cycles
- Stardust Sanctuary with 85% threshold
- Permanent adoption with natural churn

---

## 🎮 **Testing Checklist**

### Pre-Phase 3 Testing
- [ ] Test full adoption flow with observe interaction
- [ ] Verify paired guinea pigs leave store together
- [ ] Test Stardust Sanctuary unlock at 85% friendship
- [ ] Verify consumption limits reset at 100% hunger
- [ ] Test preference system (favorites, dislikes, rejection)
- [ ] Verify habitat grouping displays correctly
- [ ] Test InfoButton tooltips across all panels

### Integration Testing
- [ ] Test multiple guinea pigs with different personalities
- [ ] Verify friendship gain/loss calculations
- [ ] Test edge cases (0% friendship, 100% friendship)
- [ ] Verify adoption timer expiration and store updates
- [ ] Test manual consumption limit resets

---

## 🚀 **Commands**

**Development:**
- `npm run dev` - Start development server
- `npm run build` - Production build (run before commits)
- `npm run preview` - Preview production build

**Git:**
- Current branch: `GPS2-24`
- Main branch: `main`

---

## 📚 **Documentation Links**

- [Project Plan](PROJECT_PLAN.md)
- [Development Phases](DEVELOPMENT_PHASES.md)
- [System Integration](SYSTEM_INTEGRATION.md)
- [Phase 2 Systems](systems/phase2/)
- [Phase 2.5 Systems](systems/phase2.5/)
- [System 6.95 Implementation](systems/phase2/system-6.95-REDESIGN-implementation-plan.md)
