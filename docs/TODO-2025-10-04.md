# GPS2 Implementation TODO - October 4, 2025

**Created:** October 4, 2025
**Last Updated:** October 4, 2025
**Status:** Phase 2 Complete ‚úÖ - Manual Testing in Progress
**Next:** Phase 3 Planning

## Overview

Phase 2 is complete with all core systems (Needs, Favorites, Timing) implemented and functional. Currently in manual testing phase before transitioning to Phase 3 (Game World & Environment).

---

## üìö **Archive**

Previous TODO covering Phase 2 completion (September 28 - October 3, 2025):
- [TODO-2025-09-28.md](TODO-2025-09-28.md)

---

## üß™ **Manual Testing**

**Status:** In Progress

### Testing Focus
- [ ] Validate all Phase 2 systems integration
- [ ] Test needs decay and wellness calculation
- [ ] Verify favorites system edge cases
- [ ] Check game timing and pause/resume
- [ ] Mobile responsiveness verification

### Known Issues

**‚úÖ Pause/Resume Bug - Needs Decay Accumulation - FIXED**
- **Status:** Fixed (October 4, 2025)
- **Issue:** When pausing (via Game Controller or Needs System debug), needs continue to decay after unpausing
- **Root Cause:** Time delta accumulates during pause and applies all at once on resume
- **Fix:** Reset `needsLastUpdate` timestamps in [needsController.ts:202](src/stores/needsController.ts#L202) when `resumeProcessing()` is called
- **Impact:** High - core pause functionality now working correctly

**‚úÖ Activity Feed Not Showing Interaction Messages - FIXED**
- **Status:** Fixed (October 4, 2025)
- **Issue:** Quick actions (give water, soothe to sleep, etc.) don't show in Activity Feed
- **Root Cause:** `logActivity()` always logs to 'system' category which is filtered out of activity feed
- **Fix:** Changed all interaction methods to use `addPlayerAction()` with descriptive messages and emojis
- **Updated Methods:** feedGuineaPig, giveWater, cleanGuineaPig, playWithGuineaPig, provideChewToy, trimNails, provideShelter, sootheToSleep
- **Impact:** Medium - activity feed now shows all user interactions with guinea pigs

**‚úÖ Favorites Duplicate Bug - FIXED**
- **Status:** Fixed (October 4, 2025)
- **Issue:** Active guinea pigs can be favorited multiple times, creating duplicates; favorited guinea pigs disappeared from available list
- **Root Cause:** No duplicate check before adding to favorites, favorited non-active guinea pigs removed from available pool
- **Fix:**
  - Added duplicate check in [petStoreManager.ts:478](src/stores/petStoreManager.ts#L478) `addToFavorites()`
  - Changed behavior to keep ALL favorited guinea pigs in available pool (line 493-495)
  - Added `isGuineaPigFavorited()` helper in PetStoreDebug.vue
  - Disabled favorite button for already-favorited guinea pigs
  - Added "FAVORITED" badge to show visual status
- **Impact:** High - prevents data corruption, improves UX with consistent behavior for active and favorited guinea pigs

**‚úÖ Guinea Pigs Adopted Count Incorrect - FIXED**
- **Status:** Fixed (October 4, 2025)
- **Issue:** Starting a session with 2 guinea pigs only incremented adopted count by 1
- **Root Cause:** `incrementGuineaPigsAdopted()` always incremented by 1 regardless of session size
- **Fix:**
  - Updated `incrementGuineaPigsAdopted()` in [playerProgression.ts:138](src/stores/playerProgression.ts#L138) to accept count parameter
  - Updated `startGameSession()` in [petStoreManager.ts:673](src/stores/petStoreManager.ts#L673) to pass `guineaPigIds.length`
- **Impact:** Medium - stat now correctly tracks total guinea pigs adopted across all sessions

**‚úÖ Excessive System Message Spam - FIXED**
- **Status:** Fixed (October 4, 2025)
- **Issue:** 151+ messages after a few interactions; duplicate initialization messages
- **Root Cause:** Constant logging every 5s (needs decay, friendship changes, wellness penalties/bonuses) + duplicate store initializations
- **Fix:** Removed verbose system logs in guineaPigStore, needsController; consolidated duplicate initialization in playerProgression, petStoreManager, gameController
- **Impact:** High - reduced spam from 100s to just player actions

**‚ùå Pet Store Refresh Not Charging Money - BUG**
- **Status:** Needs Fix
- **Issue:** Refreshing the pet store does not charge the player money (End Game Penalty)
- **Expected:** Player should be charged the configured End Game Penalty amount when refreshing pet store
- **Actual:** Refresh happens for free, no currency deduction
- **Impact:** High - breaks game economy and progression balance

_(Add new findings from manual testing here)_

---

## üìù **Documentation Updates**

- [x] **Updated NEEDS_SYSTEM_TESTING_GUIDE.md** (October 4, 2025)
  - Clarified that need values are SATISFACTION levels (100% = satisfied, 0% = unsatisfied)
  - Updated all test steps to reflect correct satisfaction semantics
  - Fixed wellness calculation examples and expectations

---

## ‚ú® **Feature Enhancements**

### Enhanced Activity Feed Messages
- [x] **Implemented varied, interesting messages for quick actions** (October 4, 2025)
  - Added 8 action-specific message generators to [MessageGenerator](src/utils/messageGenerator.ts)
  - Each action now has 5+ varied message templates
  - Messages include guinea pig names for personalization
  - Special messages for favorite foods and activities
  - Updated all interaction methods in [guineaPigStore.ts](src/stores/guineaPigStore.ts) to use MessageGenerator
  - Examples:
    - "You fill Cocoa's water bottle with fresh water üíß"
    - "Cocoa gets their favorite: vegetables! ‚ú® ü•¨"
    - "You gently soothe Cocoa to sleep üò¥"
  - **Impact:** Dramatically improved player engagement with varied, delightful activity messages

---

## üé® **UI/UX Improvements**

### Needs Debug Panel Layout
- [ ] **Optimize Needs Debug Panel Layout**
  - Improve visual organization and readability
  - Better spacing and grouping of controls
  - Enhance mobile responsiveness

### Needs Debug System Control Panel
- [x] **Fix System Control panel buttons overflow at mobile** ‚úÖ
  - Fixed buttons in System Controls panel overflowing on mobile
  - Implemented responsive grid layout using `.controls-grid` utility class
  - Buttons now wrap properly and maintain consistent spacing at all screen sizes
  - Moved `.controls-grid` to base.css for reuse across debug panels
  - Button text wraps when container width decreases

### Slider Component Accessibility
- [x] **Address slider component accessibility label issue** ‚úÖ
  - Fixed accessibility warnings for slider labels (Incorrect use of `<label for=FORM_ELEMENT>`)
  - Added `id` prop to SliderField component to accept external IDs
  - SliderField now uses provided `id` prop or auto-generates one if not provided
  - External labels in NeedsDebug.vue now correctly associate with SliderField inputs
  - Renamed Slider.vue to SliderField.vue for better semantic clarity

### Logging System Form Accessibility
- [ ] **Address label issue in form groups on Logging System**
  - Fix form label associations in Logging System debug panel
  - Ensure proper label/input pairing
  - Verify accessibility compliance

### Needs Debug Panel Controls
- [x] **Disable "Pause Needs Processing" when game paused from Game Controller** ‚úÖ
  - When game is paused via Game Controller, the "Pause Needs Processing" button in Needs Debug is disabled
  - Prevents conflicting pause states between Game Controller and Needs Debug
  - Re-enables when game is resumed from Game Controller
  - Added "Paused by Game" badge indicator showing pause source
  - Button text wraps when width decreases for better mobile responsiveness

### Details Component
- [ ] **Create Details component and use it in the sections of the Guinea Pig editor**
  - Reusable component for displaying guinea pig information
  - Use in editor sections for consistent presentation
  - Mobile-responsive design with BEM methodology

---

## üìã **Next Steps**

1. **Begin Phase 3 planning** - Game World & Environment systems
2. **Update PROJECT_PLAN.md** with Phase 2 completion
3. **Review Phase 3 documentation** before implementation

---

## üîß **Development Workflow**

### Current Branch Status
- **Active Branch:** GPS2-16
- **Phase 2 Status:** Complete ‚úÖ
- **Testing Status:** Manual testing in progress

### Build & Test Commands
- **Build:** `npm run build` (run before commits)
- **Development:** `npm run dev`
- **Lint:** `npm run lint` (if available)
- **TypeScript:** `npm run typecheck` (if available)

---

## üìä **Phase Status**

### Phase 2 Complete ‚úÖ
- Pet Store & Game Session Manager (System 6.5)
- Guinea Pig Store Core (System 6)
- Guinea Pig Favorites System (System 6.9)
- Needs System (System 7)
- Game Timing System (System 8-10)

### Phase 3 Ready üìã
- Habitat Conditions (System 11)
- Habitat Items & Inventory (Systems 12-13)
- Habitat Maintenance (System 14)
