# GPS2 3D Sprint - December 27, 2025

**Started:** December 27, 2025
**Status:** Active
**Branch:** GPS2-58
**Previous Sprint:** [SPRINT-2025-12-25.md](./archived/SPRINT-2025-12-25.md)

---

## Sprint Goals

**Focus:** Behavior Parity, UI Polish, Bug Fixes

**Priority Areas:**
1. Complete all autonomous guinea pig behaviors (3D parity with 2D)
2. Fix bugs and improve UX (activity feed, camera, keyboard shortcuts)
3. UI renaming and polish
4. Visual polish for guinea pig appearance

---

## Completed This Sprint

- [x] **Fix animations not pausing** - Clouds and water bottle bubbles now pause when game is paused
- [x] **Move Help FAB to left side** - Repositioned for better UI balance
- [x] **Sidebar button icon** - Changed from ðŸ“¦ to â˜°, title to "Control Panel"
- [x] **Consolidate Help overlay to BaseDialog** - Created HelpDialog.vue, removed ~120 lines of custom CSS from Habitat3DDebug.vue, fixes scrolling issues
- [x] **Dialog scroll lock** - BaseDialog now locks body scroll when open, with scrollbar width compensation to prevent layout shift
- [x] **Fix food consumption bug** - Guinea pigs now properly consume food from bowls and hay from racks when eating (was only satisfying hunger need without removing food)

---

## Active Tasks

### Code & CSS Audit âœ…
**Priority:** HIGH (P1)
**Category:** Code Quality
**Status:** COMPLETE

**Goal:** Audit new code added since last audit (Dec 25 sprint)

**Files Audited:**
- [x] `ActionResultDialog.vue` - PASS
- [x] `usePopover.ts` - PASS
- [x] `HelpDialog.vue` - PASS

**Fixes Applied:**
- [x] `stats.css` - Fixed `border-bottom` â†’ `border-block-end`

**Checklist:**
- [x] TypeScript strict compliance
- [x] BEM naming convention
- [x] CSS logical properties
- [x] CSS variables usage
- [x] Memory management (cleanup)
- [x] Error handling

---

### Complete All Autonomous Actions
**Priority:** HIGH (P1)
**Category:** Behavior Parity

**Goal:** Implement remaining autonomous behaviors in 3D to match 2D parity

**Current 3D Behaviors:**
- [x] Eating (food bowl)
- [x] Drinking (water bottle)
- [x] Sleeping
- [x] Seek Shelter
- [x] Grooming
- [x] Pooping
- [x] Idle wandering

**Missing 3D Behaviors:**
- [ ] **Playing** - Find toys, play animation, satisfy play need
- [ ] **Socializing** - Interact with other guinea pigs, satisfy social need
- [ ] **Chewing** - Find chew items, chew animation, satisfy chew need
  - 2D reference: `useGuineaPigBehavior.ts` - activity 'chewing', threshold 40%
  - Needs: item detection for `subCategory === 'chews'`
  - Needs: chew animation trigger
  - Needs: chew need satisfaction on completion
- [x] **Hay eating** - Go to hay rack, eat hay (VERIFIED - now consumes hay from rack)

**Files to Modify:**
- `src/composables/3d/use3DBehavior.ts` - Add chew behavior logic
- `src/composables/use3DGuineaPig.ts` - Add chew animation

---

### Fix Activity Feed
**Priority:** HIGH (P1)
**Category:** Bug Fix

**Issue:** Activity feed not showing any logs except pause and resume messages

**Investigation Needed:**
- Check if activity log events are being emitted in 3D mode
- Verify activity feed component is receiving events

---

### 3D Game View Improvements
**Priority:** HIGH (P1)
**Category:** UX

**Tasks:**
- [ ] On page load, camera should have a clear centered view of the entire habitat
- [ ] When not in fullscreen, show pause button next to Enter Fullscreen button
- [ ] Rename class `habitat-3d-debug__normal-header` to `game-view__header`

---

### Keyboard Shortcuts
**Priority:** MEDIUM (P2)
**Category:** UX

**Tasks:**
- [ ] Add shortcut for pause/play
- [ ] Optimize camera control keyboard shortcuts
- [ ] Consider: shift modifier for additional camera options
  - Linear drag could move forward OR rotate view depending on modifier

---

### User-to-GP FAB & Interactions
**Priority:** MEDIUM (P2)
**Category:** Feature / UI

**Goal:** Rename Guinea Pigs FAB and implement user-initiated interactions - parity with 2D game

**UI Tasks:**
- [ ] Rename "Guinea Pigs" game-fab to something cuter (represents User-to-GP actions)
- [ ] Update icon to represent interactions
- [x] Change inventory sidebar button icon to something more generic
  - Changed from ðŸ“¦ to â˜° (hamburger menu)

**2D Actions to Port:**
- Pet
- Groom
- Hand feed
- Pick up
- Other interactions from 2D

---

### Guinea Pig Sidebar Tab Implementation
**Priority:** MEDIUM (P2)
**Category:** UI Feature

**Goal:** Build out the Guinea Pigs tab in the right sidebar (currently placeholder)

**Features to Include:**
- Full needs display with bars (all 11 needs)
- Guinea pig info (name, breed, gender, fur color/pattern)
- Friendship info
- Activity history/log

**Reference:** 2D `GuineaPigPanel.vue` for layout/features

**Files to Modify:**
- `src/components/game/Inventory3DPanel.vue` - Build out Guinea Pigs tab content

---

### Item Removal from Habitat
**Priority:** MEDIUM (P2)
**Category:** Feature

**Goal:** Allow removing placed items (toys, balls, tunnels, shelters) from habitat back to inventory

**Implementation:**
- Add click menu on placed items with "Remove" option
- Call `habitatConditions.removeItemFromHabitat()` and `inventoryStore.unmarkAsPlacedInHabitat()`

**Notes:**
- 2D version only has removal for chew items (via hover popover)
- Backend already exists, just need UI trigger

---

### Chat Bubbles
**Priority:** MEDIUM (P2)
**Category:** Feature

**Goal:** Add guinea pig chat bubbles for reactions - parity from 2D game

**Questions:**
- Would 3D chat bubbles look cute?
- Flat 3D (billboard style)?

---

### Refactor Habitat3DDebug Component
**Priority:** MEDIUM (P2)
**Category:** Code Quality

**Goal:** Extract logic from oversized component into composables before it grows further

**Extraction Candidates:**
- Container menu logic â†’ composable
- Placement mode logic â†’ composable
- FAB handlers â†’ composable
- Water bottle menu â†’ separate component

---

## Backlog (Future Refinement)

### Guinea Pig to Guinea Pig Actions (GP2GP)
**Priority:** MEDIUM (P2)
**Category:** Feature

**Goal:** Implement GP-to-GP social actions - parity with 2D game

**Actions:**
- Social
- Play
- Groom
- Greet
- Check out

---

### Replace Comfort Need with Stimulation
**Priority:** MEDIUM (P2)
**Category:** Game Design

**Goal:** Replace comfort need with stimulation need

**Notes:** This is documented in the docs folder somewhere

---

### Enhanced Habitat Physics
**Priority:** MEDIUM (P2)
**Category:** Feature

**Goal:** Add physics to habitat items like in 3D demo

**Features:**
- Clicking stick/ball makes them roll naturally
- Guinea pig can push stick, ball, and other appropriate items

---

### 3D Models
**Priority:** MEDIUM (P2)
**Category:** Assets

**Tasks:**
- Create 3D models for other food items
- Enhance hay 3D model
- Create 3D models for some other habitat items

---

### Fix Guinea Pig Collisions
**Priority:** MEDIUM (P2)
**Category:** Bug Fix

**Issue:** Guinea pigs walk through arch tunnel, igloo walls, water bottle

**Goal:** Proper collision detection/avoidance

---

### Water Bottle Drinking Animation
**Priority:** LOW (P3)
**Category:** Animation

**Goal:** Guinea pig visually drinks through water bottle spout

---

### Multiple Item Instances Testing
**Priority:** LOW (P3)
**Category:** Testing

**Goal:** Test adding multiple instances of:
- Food containers
- Water bottles
- Toys, etc.

---

### Mini Progress Bars in Habitat Care FABs
**Priority:** LOW (P3)
**Category:** UI Enhancement

**Goal:** When Habitat Care FAB is expanded, show mini progress bars in each pill

**Metrics:**
- Water level %
- Hay freshness % (average of all racks)
- Bedding freshness %
- Poop ratio (poops until dirty)

---

### Clean Up Hay Rack UI
**Priority:** LOW (P3)
**Category:** UI Polish

**Goal:** Review and polish hay rack related UI components

---

### Enhance Groom Animation
**Priority:** LOW (P3)
**Category:** Animation

**Goal:** Improve the current grooming animation

---

### Create Fur Patterns
**Priority:** LOW (P3)
**Category:** Visual Polish

**Reason:** Complex texture work, solid colors sufficient for MVP.

---

## Reference Files

| Feature | Reference |
|---------|-----------|
| Unified Behavior System | `src/composables/3d/use3DBehavior.ts` |
| Movement Controller | `src/composables/3d/use3DMovement.ts` |
| Guinea Pig Animation | `src/composables/use3DGuineaPig.ts` |
| Habitat Containers | `src/composables/useHabitatContainers.ts` |
| Hay Management Dialog | `src/components/game/dialogs/HayManagementDialog.vue` |
| Container Menu | `src/components/basic/ContainerContentsMenu.vue` |
| Inventory Panel | `src/components/game/Inventory3DPanel.vue` |
| Habitat Debug | `src/components/debug/environment/Habitat3DDebug.vue` |
| Habitat Conditions Store | `src/stores/habitatConditions.ts` |
| 2D Behavior Reference | `src/composables/useGuineaPigBehavior.ts` |
