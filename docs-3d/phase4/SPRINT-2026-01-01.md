# GPS2 Sprint - January 1, 2026

**Started:** January 1, 2026
**Status:** Phase 4 - Interactions, Animation & Visual Polish
**Branch:** main
**Previous Sprint:** [SPRINT-2025-12-31.md](archived/SPRINT-2025-12-31.md)

---

## Last Sprint Accomplishments (Dec 31)

- **Code & CSS Audit** - Audited 17 files, all passing
- **Chat Bubbles** - HTML overlay approach with world-to-screen projection
- **Item Removal from Habitat** - Click items to show popover with remove option
- **Multiple Item Placement** - Per-bottle water tracking, container content fixes
- **Chew Item Popover Menu** - Durability display and unsafe chew discard
- **FAB Color Reorganization** - Better visual hierarchy
- **Guinea Pig Collisions Fix** - Increased obstacle radii and pathfinding margins
- **Personality Debug Panel** - Added below 3D canvas with traits and preferences display

---

## Critical Bugs & Blockers

None currently blocking.

---

## Questions to Investigate

### Health Need - Keep or Remove? âœ… RESOLVED
**Status:** REMOVED - January 1, 2026

**Question:** Is the Health need a real need? Should we keep it?

**Decision:** Removed the Health need from the system.

**Rationale:**
- Health was an abstract/vague concept compared to specific needs like hunger, nails, hygiene
- The "Health Check" interaction was the only way to satisfy it (not engaging gameplay)
- Overlapped conceptually with hygiene (both about overall condition)
- Reduced need count from 11 to 10 for simpler gameplay

**Files Modified:**
- `guineaPigStore.ts` - Removed from interface, decay rates, decay modifiers, performHealthCheck()
- `needsController.ts` - Removed from wellness calculation (now 3 maintenance needs instead of 4)
- `types/supplies.ts` - Removed from NeedAffected type
- `guineaPigMessages.ts` - Removed health warning/critical messages
- `useGuineaPigBehavior.ts` - Removed health behavior mapping
- `messageGenerator.ts` - Removed generateHealthCheckMessage()
- `GuineaPigInfoMenu.vue` - Removed from popover needs display
- `PetStoreDebug.vue` - Removed decay modifier display and function
- `SliderField.vue` - Removed health slider styling
- `NeedBar.vue` - Removed health label
- `ChatBubbleDebug.vue` - Removed health option
- `variables.css` - Removed --color-need-health
- `petStoreManager.ts` - Removed from initial values

---

## High Priority Tasks

### 1. Code & CSS Audit
**Priority:** HIGH
**Status:** ğŸš§ Not Started

**Goal:** Audit all code changes since last audit (Dec 30) for quality and consistency

**Checklist:**
- [ ] BEM naming convention
- [ ] CSS variables usage
- [ ] TypeScript strict types
- [ ] THREE.js resource cleanup
- [ ] No scoped styles
- [ ] Consistent patterns

**Files to Audit:**
- [ ] `src/components/debug/environment/PersonalityPanel.vue` (new)
- [ ] `src/components/debug/environment/Habitat3DDebug.vue` (modified)
- [ ] Any other files modified since Dec 30

---

### 2. Guinea Pig Popover Improvements
**Priority:** HIGH
**Status:** ğŸš§ Not Started

**Goal:** Improve the guinea pig info popover (shown after clicking guinea pig)

**Tasks:**
- [ ] Add overall wellness display in header (progress bar + percentage below name)
- [ ] Convert "Take Control" button to icon-only button with title tooltip
- [ ] Add "Pet" icon-only button that triggers U2G pet interaction
- [ ] Add "Hand Feed" icon-only button that triggers U2G hand-feed interaction
- [ ] Make action buttons smaller and inline beneath the needs display

**Design:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cinnamon                  âœ• â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 78% Wellness     â”‚  â† NEW
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Hunger    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  82    â”‚
â”‚ ...                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Files to Modify:**
- `src/components/game/GuineaPigInfoMenu.vue`
- `src/stores/needsController.ts` (use calculateWellness)

---

### 3. Guinea Pig Sidebar Panel Reorganization
**Priority:** HIGH
**Status:** ğŸš§ Not Started

**Goal:** Clean up Guinea Pig sidebar panel structure

**Tasks:**
- [ ] Extract Guinea Pig info tab from `Inventory3DPanel.vue` into its own component file
- [ ] Show number of interactions between guinea pigs in the Guinea Pig sidebar panel tab

**Files to Modify:**
- `src/components/game/Inventory3DPanel.vue`
- New: `src/components/game/GuineaPigTab.vue` (or similar)

---

### 4. Personality Debug Panel Enhancements
**Priority:** MEDIUM
**Status:** ğŸš§ Not Started

**Goal:** Add Need Decay Rate Modifiers to the Personality debug panel

**Context:** The Guinea Pigs debug page shows decay rate modifiers based on personality. Add this to the personality panel below the 3D game view canvas.

**Analysis:**
- `guineaPigStore.ts` has `getPersonalityDecayModifier()` - the real calculation used in game logic
- `PetStoreDebug.vue` has 6 duplicate helper functions (`getSocialDecayModifier`, etc.)
- The store function is **not exported**, so PetStoreDebug reimplemented the formulas

**Tasks:**
- [ ] Export `getPersonalityDecayModifier` from guineaPigStore (or create utility file)
- [ ] Refactor `PetStoreDebug.vue` to use centralized function
- [ ] Add decay modifiers section to `PersonalityPanel.vue` using same function

**Files to Modify:**
- `src/stores/guineaPigStore.ts` - Export the function
- `src/components/debug/core/PetStoreDebug.vue` - Remove duplicate helpers
- `src/components/debug/environment/PersonalityPanel.vue` - Add decay modifiers display

---

## Medium Priority Tasks

### User-to-GP Interactions (5 Remaining)
**Status:** ğŸš§ In Progress (carried from previous sprint)

**Completed:**
- [x] Pet interaction
- [x] Hand Feed interaction

**Remaining:**
- [ ] **Hold** - Pick up guinea pig (+20-30% social, +2 friendship)
- [ ] **Gentle Wipe** - Cleaning (+40-50% cleanliness, +5% social, +1 friendship)
- [ ] **Show Toy** - Show toy to GP (+10-15% play, +5% social, +1 friendship)
- [ ] **Trim Nails** - Nail maintenance (+40-50% nails, +1 friendship)
- [ ] **Talk To** - Voice interaction (+10-15% social, +1 friendship)

---

### GP-to-GP Social Interactions
**Status:** ğŸš§ In Progress (carried from previous sprint)

**Completed:**
- [x] Add GP-to-GP FAB button (golden yellow)
- [x] Create FabSubnavMenu with social actions (orange theme)
- [x] Add pending social action state and instruction overlay
- [x] Wire up GP click to check for pending social action
- [x] Call `useSocialBehaviors.ts` functions on GP selection
- [x] Add 3D animation for "Approach Companion" action
- [x] Add autonomous social behavior to 3D behavior system

**Remaining:**
- [ ] Add 3D animations for remaining social interactions (play, groom)

**Social Actions Menu:**
| Action | Icon | Status |
|--------|------|--------|
| Approach Companion | ğŸš¶ | âœ… Complete |
| Play Together | ğŸ¾ | ğŸš§ Needs animation |
| Groom Partner | âœ¨ | ğŸš§ Needs animation |
| Share Food | ğŸ¥¬ | ğŸš§ Needs animation |
| Greet | ğŸ‘‹ | ğŸš§ Needs animation |

---

### Replace Comfort Need with Stimulation
**Status:** ğŸ“‹ Planned
**Goal:** Replace comfort need with stimulation need (documented in docs folder)

---

## Low Priority (Backlog)

### GameView.vue Refactoring
**Status:** ğŸ“‹ Planned

**Issue:** GameView.vue has grown to 1634+ lines and is becoming bloated.

**Goal:** Analyze and extract logic into appropriate composables/helper files.

**Potential Extractions:**
- [ ] Click/raycast handling â†’ `use3DClickHandler.ts`
- [ ] Guinea pig model management â†’ enhance `use3DGuineaPig.ts`
- [ ] Animation loop logic â†’ `use3DAnimationLoop.ts`
- [ ] Chewing state management â†’ already in `use3DBehavior.ts`
- [ ] Popover/menu coordination â†’ `use3DMenus.ts` aggregator

---

### Transition to External GLTF Models
**Status:** ğŸ“‹ Planned

**Goal:** Move from procedural THREE.js geometry to external GLTF/GLB model files for better scalability

**Benefits:**
- Models don't bloat JS bundle (loaded on demand)
- Can use Blender for more detailed/complex models
- Enables LOD (level of detail) for performance
- Easier artist workflow

**Tasks:**
- [ ] Set up `public/models/` directory structure
- [ ] Create model loader utility with caching
- [ ] Convert existing procedural models to GLTF (Blender export)
- [ ] Implement lazy loading for model categories
- [ ] Add loading states/placeholders while models load

**Model Categories:**
- Guinea pigs (with fur pattern variants)
- Habitat items (bowls, bottles, shelters)
- Food items (vegetables, hay, pellets)
- Enrichment items (toys, tunnels, hideouts)

---

### Add "Move Object" Button to Habitat Items
**Status:** ğŸ“‹ Planned

**Goal:** Allow repositioning placed items without removing and re-placing

**Scope:** Any item that has a "Move to Inventory" button should also have a "Move Object" button

**Tasks:**
- [ ] Add "Move Object" button to item popovers (ItemPopover3D, ContainerContentsMenu, WaterBottleMenu, ChewPopover3D)
- [ ] Re-enter placement mode with existing item selected
- [ ] Remove item from old position when new position confirmed
- [ ] Update obstacle positions in pathfinding

---

### Preference & Personality Discovery System
**Status:** ğŸ“‹ Planned

**Goal:** Add a discovery mechanic where players learn guinea pig preferences and personality traits through gameplay

**Preference Discovery:**
- Add "Preferences" section to Guinea Pig sidebar panel
- Preferences start as "Unknown" (greyed out slots)
- Discovery flow:
  1. Give item/food to guinea pig
  2. See reaction chat bubble (positive/negative)
  3. Click the chat bubble in time to "record" the discovery
  4. Preference is revealed in the guinea pig's profile

**Personality Discovery (TBD):**
- Observe behaviors over time?
- Specific interaction sequences?
- Random events that reveal traits?
- Bonding milestones?

**UI Tasks:**
- [ ] Add "Preferences" section to GuineaPigSidebar
- [ ] Create preference slot component (unknown/discovered states)
- [ ] Add "click to discover" interaction on chat bubbles
- [ ] Store discovered preferences in guinea pig data
- [ ] Visual feedback when preference is discovered

**Preference Categories:**
- Favorite food
- Favorite toy
- Favorite activity
- Dislikes

---

### Other Backlog Items
- Water bottle drinking animation
- Mini progress bars in Habitat Care FABs
- Bedding items should look disabled in Inventory Panel
- Enhance groom animation
- Create fur patterns

---

## Sprint Completion Criteria

Before closing this sprint:
- [ ] Guinea Pig popover improvements completed
- [ ] Guinea Pig sidebar panel reorganized
- [ ] Personality debug panel shows decay modifiers
- [ ] All changes documented in sprint doc
- [ ] `npm run build` passes

---

## Commands

**Development:**
- `npm run dev` - Start development server
- `npm run build` - Production build (run before commits)
- `npm run preview` - Preview production build

**Git:**
- Current branch: `main`
- Main branch: `main`

---

## Reference Files

| Feature | Reference |
|---------|-----------|
| Guinea Pig Popover | `src/components/game/GuineaPigInfoMenu.vue` |
| Inventory Panel | `src/components/game/Inventory3DPanel.vue` |
| Personality Panel | `src/components/debug/environment/PersonalityPanel.vue` |
| 3D Interactions | `src/composables/3d/use3DInteractions.ts` |
| Chat Bubbles | `src/composables/3d/use3DChatBubbles.ts` |
| Social Actions 3D | `src/composables/3d/use3DSocialActions.ts` |
| Guinea Pig Store | `src/stores/guineaPigStore.ts` |
| Habitat Debug | `src/components/debug/environment/Habitat3DDebug.vue` |

---

## Documentation Links

- [Project Plan](../../PROJECT_PLAN.md)
- [Development Phases](../../DEVELOPMENT_PHASES.md)
- [Previous Sprint](archived/SPRINT-2025-12-31.md)
