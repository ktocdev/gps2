# GPS2 Sprint - December 31, 2025

**Started:** December 31, 2025
**Status:** Phase 4 - Interactions, Animation & Visual Polish
**Branch:** main
**Previous Sprint:** [SPRINT-2025-12-28.md](../phase3.5/archived/SPRINT-2025-12-28.md)

---

## Last Sprint Accomplishments (Dec 28-30)

- **Mobile Optimization** - Pinch-to-zoom, two-finger pan, safe area support, dynamic viewport height
- **New 3D Food Models** - Carrot stick, pellet pile, lettuce pile with food routing system
- **UI Color Contrast Fixes** - Green/cyan FAB colors, cyan color palette, activity log icon
- **Code Audit & Bug Fixes** - Index bounds, food selection reset, CSS logical properties, cleanup
- **Interaction Handler Refactoring** - Extracted petting/hand-feed to `use3DInteractions.ts` composable
- **Model Viewer Mobile** - Touch controls, mobile-first styles, UX fixes

---

## Critical Bugs & Blockers

None currently blocking. Medium priority bugs carried to backlog.

---

## High Priority Tasks

### 1. Code & CSS Audit
**Priority:** HIGH
**Status:** âœ… Complete

**Goal:** Audit all code changes since last audit (Dec 28) for quality and consistency

**Files Audited (17 total):**

*Initial audit (Dec 30 changes):*
- `src/composables/3d-models/food/pellets.ts` âœ…
- `src/composables/3d-models/food/greens.ts` âœ…
- `src/composables/3d-models/food/vegetables.ts` âœ…
- `src/composables/3d-models/containers/bowls.ts` âœ…
- `src/components/debug/prototypes/ModelViewerDebug.vue` âœ…
- `src/styles/game-fab.css` âœ…
- `src/styles/variables.css` âœ…

*Additional audit (Dec 28-30 missed files):*
- `src/composables/3d-models/food/held-food.ts` âœ…
- `src/composables/3d/use3DInteractions.ts` âœ…
- `src/composables/use3DCamera.ts` âœ…
- `src/styles/game-view.css` âœ…
- `src/components/game/SidePanel3D.vue` âœ…
- `src/components/debug/environment/Habitat3DDebug.vue` âœ…
- `src/components/game/GameView.vue` âœ…
- `src/composables/3d-models/shelters/tunnels.ts` âœ…
- `src/constants/3d.ts` âœ…
- `src/types/supplies.ts` âœ…

**Checklist Results:**
- [x] BEM naming convention
- [x] CSS logical properties (no physical margin/padding)
- [x] CSS variables usage
- [x] TypeScript strict types
- [x] THREE.js resource cleanup
- [x] No scoped styles
- [x] Consistent patterns

**Result:** All 17 files pass with no issues found.

---

### 2. Chat Bubbles
**Priority:** HIGH
**Status:** ðŸ“‹ Planned

**Goal:** Add guinea pig chat bubbles for reactions - parity with 2D game

**Implementation Options:**
- Billboard-style 3D sprites that always face camera
- HTML overlay positioned above guinea pig
- CSS3D renderer for crisp text

**Tasks:**
- [ ] Research best approach for 3D chat bubbles
- [ ] Create chat bubble component/mesh
- [ ] Position above guinea pig head
- [ ] Trigger on interactions (petting, feeding, etc.)
- [ ] Add reaction text/emoji content
- [ ] Auto-dismiss after duration

**Reference:** 2D chat bubble implementation in existing codebase

---

### 3. Item Removal from Habitat
**Priority:** HIGH
**Status:** ðŸ“‹ Planned

**Goal:** Allow removing placed items (toys, balls, tunnels, shelters) from habitat back to inventory

**Implementation:**
- [ ] Add click/tap handler on placed items
- [ ] Show context menu with "Remove" option
- [ ] Call `habitatConditions.removeItemFromHabitat()`
- [ ] Call `inventoryStore.unmarkAsPlacedInHabitat()`
- [ ] Remove 3D model from scene
- [ ] Add activity log entry

**Notes:**
- 2D version only has removal for chew items (via hover popover)
- Backend already exists, just need UI trigger

---

### 4. Multiple Item Placement
**Priority:** HIGH
**Status:** ðŸ“‹ Planned

**Goal:** Support placing multiple instances of same item type in habitat

**Tasks:**
- [ ] Test current behavior with multiple food bowls
- [ ] Test with multiple water bottles
- [ ] Test with multiple toys
- [ ] Fix any issues with instance tracking
- [ ] Ensure each instance has unique position/state

---

## Medium Priority (Backlog)

### User-to-GP Interactions (5 Remaining)
**Status:** ðŸš§ In Progress (from previous sprint)

**Completed:**
- [x] Pet interaction
- [x] Hand Feed interaction

**Remaining:**
- [ ] **Hold** - Pick up guinea pig (+20-30% social, +2 friendship)
- [ ] **Gentle Wipe** - Cleaning (+40-50% cleanliness, +5% social, +1 friendship)
- [ ] **Show Toy** - Show toy to GP (+10-15% play, +5% social, +1 friendship)
- [ ] **Peek-a-Boo** - Playful interaction (+10% social, +1 friendship)
- [ ] **Talk To** - Voice interaction (+10-15% social, +1 friendship)

---

### GP-to-GP Social Interactions
**Goal:** Guinea pig seeks out another GP when social need is low

**Tasks:**
- [ ] Autonomous socializing behavior
- [ ] Approach animation
- [ ] Social interaction effects
- [ ] Player-initiated GP2GP actions

---

### Fix Guinea Pig Collisions
**Issue:** Guinea pigs walk through arch tunnel, igloo walls, water bottle

**Goal:** Proper collision detection/avoidance

---

### Replace Comfort Need with Stimulation
**Goal:** Replace comfort need with stimulation need (documented in docs folder)

---

## Low Priority (Backlog)

- Water bottle drinking animation
- Multiple item instances testing
- Mini progress bars in Habitat Care FABs
- Bedding items should look disabled in Inventory Panel
- Enhance groom animation
- Create fur patterns

---

## Sprint Completion Criteria

Before closing this sprint:
- [x] Code & CSS audit completed with fixes applied
- [ ] Chat bubbles implemented and working
- [ ] Item removal from habitat working
- [ ] Multiple item placement tested and working
- [ ] All changes documented in sprint doc
- [ ] `npm run build` passes

---

## Commands

**Development:**
- `npm run dev` - Start development server
- `npm run build` - Production build (run before commits)
- `npm run preview` - Preview production build

**Git:**
- Current branch: `main`
- Main branch: `main`

---

## Reference Files

| Feature | Reference |
|---------|-----------|
| 3D Interactions | `src/composables/3d/use3DInteractions.ts` |
| Container Menu | `src/composables/3d/use3DContainerMenu.ts` |
| Placement Mode | `src/composables/3d/use3DPlacement.ts` |
| Habitat Care | `src/composables/3d/use3DHabitatCare.ts` |
| 3D Hand Model | `src/composables/3d-models/use3DHand.ts` |
| Food Models | `src/composables/3d-models/food/` |
| Model Viewer | `src/components/debug/prototypes/ModelViewerDebug.vue` |
| Habitat Debug | `src/components/debug/environment/Habitat3DDebug.vue` |
| Habitat Conditions | `src/stores/habitatConditions.ts` |

---

## Documentation Links

- [Project Plan](../../PROJECT_PLAN.md)
- [Development Phases](../../DEVELOPMENT_PHASES.md)
- [Previous Sprint](../phase3.5/archived/SPRINT-2025-12-28.md)
